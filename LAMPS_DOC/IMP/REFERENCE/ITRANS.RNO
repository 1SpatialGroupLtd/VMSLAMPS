
.PAGE
.NO FILL
^*--------------------------------------------------------------------------------\*
^*MODULE\*####ITRANS
.INDEX ITRANS
.BLANK
.NO FILL
.NO JUSTIFY
^*--------------------------------------------------------------------------------\*
^*REPLACES\*##Projection computation and transformation functions of IPR
.INDEX DAMP
.INDEX DAMP> IPR
.BLANK
^*--------------------------------------------------------------------------------\*
.HL 2 ^*FUNCTION\*
.LEFT MARGIN +10
.INDEX ITRANS> FUNCTION
.INDEX IMP> module functions> coordinate transformation

.P 0;ITRANS is a general map projection program. It allows changes in
geodetic datum, transformation between spheroidal data (latitude and
longitude) and  specified map projections (and will also transform data
from one map projection directly into another).
.BL
It can also be used to transform data from one coordinate space to
another, where the relationship between the coordinate systems are not
known, but the values of several common points in each system are.
Several different formulae are available for this approach, the required
parameters being empirically determined from the common points.

.BL
ITRANS is primarily intended for operation on data held in IFF files,
but it can also be used to transform individual points. 

.LEFT MARGIN -10
.BLANK
.TP 17
^*--------------------------------------------------------------------------------\*
.INDEX ITRANS> FORMAT
.HL 2 ^*FORMAT\*
.NO FILL
.NO JUSTIFY
.LEFT MARGIN +10
$ ITRANS input-file-spec [output-file-spec]

^*Command Qualifiers                    Defaults\*
.INDEX ITRANS> command qualifiers

/[NO]ABSOLUTE                           /NOABSOLUTE
.INDEX ITRANS> command qualifiers> /ABSOLUTE
/[NO]CONTROL                            /NOCONTROL
.INDEX ITRANS> command qualifiers> /CONTROL
/[NO]DATUM__SHIFT                        /NODATUM__SHIFT
.INDEX ITRANS> command qualifiers> /DATUM__SHIFT
/DESCRIPTOR                             None.
.INDEX ITRANS> command qualifiers> /DESCRIPTOR
/[NO]HEIGHT__ADJUST                      /NOHEIGHT__ADJUST
.INDEX ITRANS> command qualifiers> /HEIGHT__ADJUST
/[NO]FOUR                               /NOFOUR
.INDEX ITRANS> command qualifiers> /LEARNER
/[NO]LEARNER                            /NOLEARNER
.INDEX ITRANS> command qualifiers> /FOUR
/[NO]LOG                                /NOLOG
.INDEX ITRANS> command qualifiers> /LOG
/[NO]OUTPUT[=file-spec]                 /NOOUTPUT (see text)
.INDEX ITRANS> command qualifiers> /OUTPUT
/POINT                                  None.
.INDEX ITRANS> command qualifiers> /POINT
/[NO]PROJECTIVE                         /NOPROJECTIVE
.INDEX ITRANS> command qualifiers> /PROJECTIVE
/[NO]RETAIN__CP                          /NORETAIN__CP
.INDEX ITRANS> command qualifiers> /RETAIN__CP
/[NO]SIX                                /NOSIX
.INDEX ITRANS> command qualifiers> /SIX
/[NO]THREE                              /NOTHREE
.INDEX ITRANS> command qualifiers> /THREE
/[NO]TWO                                /NOTWO
.INDEX ITRANS> command qualifiers> /TWO

.BLANK
.LEFT MARGIN -10
.TP 4
^*--------------------------------------------------------------------------------\*
.HL 2 ^*PROMPTS\*
.INDEX ITRANS> PROMPTS
.NO FILL
.NO JUSTIFY
.LEFT MARGIN +10
__Input File: 	input-file-spec
__Output File:	output-file-spec

.BLANK
.LEFT MARGIN -10
.TP 10
^*--------------------------------------------------------------------------------\*
.HL 2 ^*COMMAND PARAMETERS\*
.FILL
.INDEX ITRANS> PARAMETERS
.LEFT MARGIN +10
.P -10;input-file-spec
.P 0;Specifies the input IFF file to be operated on.
.P 0;Any part of the file specification that is not supplied will be
completed from the default of "LSL$IF:IFF.IFF;0" 
.TP 8
.P -10;output-file-spec

.P 0;Specifies the name of the IFF file to be created.

.P 0;Any part of the file-spec that is not specified will be completed
from the parsed input file-spec (without a version number). 


.P 0;A version number must not be included as the user has no control of
the version number of the file to be created. A new file will be created
with a version number one higher than the current highest existing in
the directory. 

.LEFT MARGIN -10
.BLANK
.TP 11
^*--------------------------------------------------------------------------------\*
.HL 2 ^*RESTRICTIONS\*
.INDEX ITRANS> RESTRICTIONS
.LEFT MARGIN +10
.FILL
.LIST "o"
.LE
ITRANS can only be used to convert data from one geodetic datum onto
another, when the data is held as geographical coordinates (i.e_.
latitude and longitude) 
.LE
/POINT and command parameters are mutually exclusive
.LE
/DESCRIPTOR and two command parameters are mutually exclusive
.LE
/POINT and /DESCRIPTOR qualifiers are mutually exclusive
.LE
/POINT and any of /FOUR, /PROJECTIVE, /SIX, /THREE and /TWO are mutually
exclusive 
.LE
/DESCRIPTOR and any of /FOUR, /PROJECTIVE, /SIX, /THREE and /TWO are mutually
exclusive 
.LE
Only one of /FOUR, /PROJECTIVE, /SIX, /THREE and /TWO are valid
.LE
/CONTROL can only be used in conjunction with one of /FOUR, /PROJECTIVE,
/SIX, /THREE or /TWO
.LE
/SIX can only be used in conjunction with /CONTROL
.LE
/DATUM__SHIFT and any of /FOUR, /PROJECTIVE, /SIX, /THREE and /TWO are mutually
exclusive 
.LE
/HEIGHT__ADJUST can only be used in conjunction with /DATUM__SHIFT
.LE
/RETAIN__CP can only be used in conjunction with /DATUM__SHIFT
.LE
Empirical transformations cannot be carried out on geographical data (ie
data held as latitude and longitude)
.LE
ITRANS does not usually perform transformations on the z value in ZS (3d
string) or CB (coordinate block) entries but copies them, unaltered, to
the output file. The x and y values are transformed. When doing the most
accurate geodetic datum shift calculations, the z value is, however,
altered. 
.LE
ITRANS only transforms coordinates; it has no knowledge of any implied
connections between these coordinates. It is the user's responsibility
to ensure that data is suitable for the target projection. In
particular, users should be aware that points that lie close together on
one coordinate system may lie on different sides of a discontinuity on
another. For example, two points with longitude 179.9 W and 179.9 E are
close together on the surface of the earth but project to different
extremities of a World projection with a central meridian through
Greenwich. If, to avoid this problem, all data is split along 180.0 E,
then this data will not be suitable to project onto a world projection
with a different central meridian.
.END LIST
.NF
.LEFT MARGIN -10
.TP 12
^*--------------------------------------------------------------------------------\*
.HL 2 ^*COMMAND QUALIFIERS\*
.BLANK
.INDEX ITRANS> COMMAND QUALIFIERS
.LEFT MARGIN +10
.P -10;/ABSOLUTE
.I -10;/NOABSOLUTE
.INDEX ITRANS> command qualifiers> /ABSOLUTE
.P -2;-#controls whether the numbers used as the right hand side of the
control points when doing empirical transformations are to be retained, or
whether they are all to be reduced by their minimum x and minimum y
values and these values used as the local origin for the input data. 
.B
By default the values are reduced to give all the final control points
positive values and also, usually, to reduce their absolute size. 
.BLANK 2
.P -10;/CONTROL[=file-spec]
.I -10;/NOCONTROL
.INDEX ITRANS> command qualifiers> /CONTROL
.P -2;-#specifies that a file containing the control points for an
empirical transformation is to be used as opposed to those
in the CP entry in the IFF file.
.B
The file can contain up to twenty lines of control points in the order
.NOFILL
.B
		ORIGINAL X  ORIGINAL Y  TARGET X  TARGET Y
.B
.FILL
and comments may be included either, on separate lines anywhere in the file,
or at the end of a line of control points.  ITRANS will read ! and ; as comment
characters and anything occurring before either of these, other than the control
points, will cause an error.
.NOTE
The coordinates in this file should be entered as absolute values. Any
origin offsets are handled automatically, so the user need not know
about the relative coordinates that are actually stored in the file.
.END NOTE
.B
Each of the formulae available for empirical transformations will take
up to the maximum number of lines of control points and, using the least
squares method, return the best fit.  Each  of them also requires a
minimum number of control points, as follows,
.NOFILL
.B
.TP 5
/TWO            minimum 2  maximum 800
/THREE          minimum 3  maximum 800
/FOUR           minimum 4  maximum 800
/PROJECTIVE     minimum 4  maximum 800
/SIX            minimum 6  maximum 800
.B
.FILL
.TP10
If /CONTROL is entered with no file-spec, or a partial one, then the
missing parts of the file-spec are taken from the default specification 
CONTROL.DAT.
.B
The default is /NOCONTROL.
.BLANK 2
.P -10;/DATUM__SHIFT
.I -10;/NODATUM__SHIFT
.INDEX ITRANS> command qualifiers> /DATUM__SHIFT
.P -2;-#specifies that ITRANS is to carry out a conversion of geodetic
datum.
.B
The default is /NODATUM__SHIFT and ITRANS carries out projection
transformations, rather than geodetic datum shifts. 
.BLANK 2
.TP 8
.P -10;/DESCRIPTOR
.INDEX ITRANS> command qualifiers> /DESCRIPTOR
.P -2;-#specifies that ITRANS is only to update the map descriptor 
entry in the IFF file without doing any transformations on the data.
.B
This qualifier should precede all other qualifiers on the command line.
.B
By default, ITRANS does not allow the existing map descriptor entry to be
altered, and transforms all the coordinate values in the file.
.INDEX ITRANS> command qualifiers> /DESCRIPTOR> a warning
.NOTE WARNING
If there is an existing version 2 map descriptor in the IFF file, then
the MD entry will be overwritten in the existing file. If there is not a
version 2 MD entry then a new version of the file will be created. 
.END NOTE
.B2
.TP 10
.P -10;/FOUR
.I -10;/NOFOUR
.INDEX ITRANS> command qualifiers> /FOUR
.P -2;-#specifies that ITRANS is to carry out an empirical
transformation on the data based on the the "extended four point"
formulae.
.B
See below for details of the transformation used.
.B
The default is /NOFOUR, and ITRANS carries out a projection,  rather
than an empirical,  transformation.
.BLANK 2
.P -10;/HEIGHT__ADJUST
.I -10;/NOHEIGHT__ADJUST
.INDEX ITRANS> command qualifiers> /HEIGHT__ADJUST
.P -2;-#specifies that ITRANS is to use the heights of points when doing
geodetic datum conversion.
.B
.TP10
The default is /NOHEIGHT__ADJUST and ITRANS ignores the height of points
when doing the conversion.
.B
This command is only valid in conjunction with the /DATUM__SHIFT
qualifier. 
.BLANK 2
.TP 10
.P -10;/LEARNER
.I -10;/NOLEARNER
.INDEX ITRANS> command qualifiers> /LEARNER
.P -2;-#specifies that ITRANS is to give help, before prompting for 
each bit of information.
.B
The default is /NOLEARNER
.NOTE
Help on any particular prompt can be obtained by responding with "?"
.END NOTE
.B
.P -10;/LOG
.I -10;/NOLOG
.INDEX ITRANS> command qualifiers> /LOG
.P -2;-#controls the number of messages that ITRANS sends to SYS$OUTPUT.
E_.g_. when /LOG is specified messages are received when IFF files are
successfully opened. 
.B
The default is /NOLOG
.BLANK 2
.TP 10
.P -10;/OUTPUT[=file-spec]
.I -10;/NOOUTPUT
.INDEX ITRANS> command qualifiers> /OUTPUT
.P -2;-#controls where the record of the session is to be sent.
.B
The record of the session consists of the input and output map
descriptors, any control points used for empirical transformations and
either the name of the input and output IFF files or a list of the
individual points that have been transformed (when the /POINT has been
used). 
.B
If /OUTPUT is entered with no file-spec, or a partial one, then the 
missing parts of the file-spec are taken from the default specification 
SYS$DISK:ITRANS_.LIS.
.B
By default this record is sent to SYS$OUTPUT.
.BLANK 2
.TP 10
.P -10;/POINT
.INDEX ITRANS> command qualifiers> /POINT
.P -2;-#allows ITRANS to be used to transform individual points.
.B
This qualifier should precede all other qualifiers on the command line.
.B
An ASCII file of X and Y coordinate pairs can be read by giving the
command "@filename" to the prompt asking for the coordinates of a point 
to convert.
.B
By default ITRANS operates on IFF files.
.B2
.TP 10
.P -10;/PROJECTIVE
.I -10;/NOPROJECTIVE
.INDEX ITRANS> command qualifiers> /PROJECTIVE
.P -2;-#specifies that ITRANS is to carry out an empirical
transformation on the data based on the the "projective transformation"
formulae.
.B
See below for details of the transformation used.
.B
The default is /NOPROJECTIVE, and ITRANS carries out a projection, 
rather than an empirical,  transformation.

.BLANK 2
.TP 10
.P -10;/RETAIN__CP
.I -10;/NORETAIN__CP
.INDEX ITRANS> command qualifiers> /RETAIN__CP
.P -2;-#specifies that ITRANS is not to transform the CP (control point)
entry while doing a geodetic datum conversion.
.B
This qualifier is for use when the control points are graticule based, and
the user wishes to move the data relative to them.
.B
The default is /NORETAIN__CP and ITRANS transforms the control points as
normal.
.B
This command is only valid in conjunction with the /DATUM__SHIFT
qualifier. 
.B2
.TP 10
.P -10;/SIX
.I -10;/NOSIX
.INDEX ITRANS> command qualifiers> /SIX
.P -2;-#specifies that ITRANS is to carry out an empirical
transformation on the data based on the general second order
transformation formulae.
.B
See below for details of the transformation used.
.B
The default is /NOSIX, and ITRANS carries out a projection, 
rather than an empirical,  transformation.
.B2
.TP 10
.P -10;/THREE
.I -10;/NOTHREE
.INDEX ITRANS> command qualifiers> /THREE
.P -2;-#specifies that ITRANS is to carry out an empirical
transformation on the data based on the the "affine" formulae.
.B
See below for details of the transformation used.
.B
The default is /NOTHREE, and ITRANS carries out a projection, 
rather than an empirical,  transformation.
.BLANK 2
.TP 10
.P -10;/TWO
.I -10;/NOTWO
.INDEX ITRANS> command qualifiers> /TWO
.P -2;-#specifies that ITRANS is to carry out an empirical
transformation on the data based on the the "orthogonal transformation"
formulae.
.B
See below for details of the transformation used.
.B
The default is /NOTWO, and ITRANS carries out a projection, 
rather than an empirical,  transformation.

.TP 15
.LEFT MARGIN -10
.B2
^*--------------------------------------------------------------------------------\*
.HL 2 ^*DESCRIPTION\*
.INDEX ITRANS> DESCRIPTION
.LEFT MARGIN +7
.LIST "o"
.TP 10
.LE;^*The MD (Map Descriptor) entry.\*
.INDEX ITRANS> DESCRIPTION> the MD entry
.INDEX ITRANS> and the MD entry
.INDEX IFF MD entry
.INDEX IFF MD entry> and ITRANS
.INDEX MD entry
.INDEX MD entry> and ITRANS
.B
The MD (Map Descriptor) entry in the IFF file carries information about
the projection that the coordinate data is currently held in.  Each run
of ITRANS will ask the operator for details of the required projection
and the data in the file will be transformed into this projection in a
new IFF file with a corresponding MD entry. 

.INDEX ITRANS> and the MD entry> incompatibility with DAMP IPR
.INDEX DAMP IPR> incompatibility with ITRANS
.INDEX DAMP IPR> incompatibility with type 2 MD
.NOTE
The MD entry produced by ITRANS is of a different structure and length
from that used by IPR, and thus the use of IPR and ITRANS are mutually
exclusive. The new MD is called a "version 2 Map Descriptor" 
.END NOTE
If ITRANS is run in its  projection or datum__shift mode on an IFF file
without a valid, or complete, version 2 MD entry, the operator will be
asked to enter details of the current projection before being asked for
the required projection. The IFF file resulting from the transformation
will contain a valid version 2 MD entry. 
.B
If however ITRANS is run in its empirical transformation mode on an IFF
file without a valid or complete version 2 MD entry, then the operator
will only be asked to supply the origin offset for the output IFF file.
A version 2 MD entry will be created in the output file, but the other
entries in it will be set to 0.0, or will be unset. 
.TP10
.B 
ITRANS can be used to edit an existing version 2 MD entry (or insert
one, if none exists) without transforming any of the coordinate data. 
.B
.INDEX IFF MD entry> contents
.INDEX ITRANS> IFF MD entry> contents
The version 2 map descriptor contains the following information:-
.LIST
.DISPLAY ELEMENTS RL,")"
.LE;The local origin for the IFF file.
.B
This is an XY coordinate pair, each held as a REAL_*8 (double precision)
number, that is added to any pair of coordinates in the IFF file to give
the true projection coordinates of the points. 
.BR
This allows the absolute size of the coordinates in the IFF file, which
are only held as REAL_*4 (single precision) numbers to be reduced, thus
avoiding problems of rounding and reduced accuracy. 
.LE; The scale of the map that the IFF file represents.
.B
This is a REAL_*8 (double precision) number which when multiplied by map
(or sheet) units gives IFF units - e_.g_. 50000_.0 for a 1:50000 map. 
.BR
It is used to relate IFF units to e_.g_. symbol and text sizes on the
map sheet and also as a general indication of the accuracy of the
digital data. 
.LE;The spheroid that the data relates to.
.B
.INDEX ITRANS> geodetic datum
All geographical data is ultimately related to a particular geodetic
datum. A geodetic datum is defined by the shape and size of a reference
spheroid and by its orientation with respect to the earth. The data
about the spheroid is held in the map descriptor; the other elements of
the geodetic datum are discussed below under "Carrying out datum shifts".
.TP 12
.BL 2
The spheroid is the geometrical model of the earth that was used when
the original survey was carried out.
.B
.INDEX ITRANS> supported spheroids
.INDEX ITRANS> spheroids
.INDEX ITRANS> available spheroids
The spheroids that ITRANS knows about, and their code numbers are as
follows:- 
.LEFT MARGIN +5
.NOFILL
  0 Clarke 1866
  1 Clarke 1880
  2 Bessel
  3 New International 1967
  4 International 1924 (Hayford 1909)
  5 World Geodetic System 72 (WGS 72)
  6 Everest
  7 World Geodetic System 66 (WGS 66)
  8 Geodetic Reference System 1980 (GRS 1980)
  9 Airy
 10 Modified Everest
 11 Modified Airy
 12 Walbeck
 13 Southeast Asia
 14 Australian National
 15 Krassovsky
 16 Hough
 17 Mercury 1960
 18 Modified Mercury 1968
 19 Sphere of radius 6370997 M
 20 Sphere of radius 6371229.3M
 21 Clarke 1880 (IGN)
 22 World Geodetic System 84 (WGS 84)
101 User specified spheroid
.FILL
.LEFT MARGIN -5
.B
.INDEX ITRANS> spheroid codes
.ENTRY ITRANS> spheroid codes> see Appendix A
The spheroid code is held in the map descriptor as an integer; when code
101 is specified two additional REAL_*8 (double precision) values are
also stored (see below). 
.B
.INDEX ITRANS> spheroid shape

The shape of a spheroid is determined by the relationship between the
semi-major (equatorial) and semi-minor (polar) axes of the ellipsoid of
revolution. This is all that is required if geographical coordinates are
required as they are expressed in angular units, and are thus scaleless. 
.B
.INDEX ITRANS> spheroid size
The size of the spheroid is also important, and this is determined by
defining the length of one of the axes of the ellipsoid.  The shape and
size of the spheroid  can thus be uniquely defined by specifying the
length of the semi-major and semi-minor axes. 
.B
When points on the spheroid are related to a plane, i_.e_. a projection,
the units of the projection are the units that the lengths of axes of
the spheroid were expressed in. All the spheroids specified above are
defined within ITRANS in international metres. 
.B
 See Appendix A for the details of these spheroids.
.B
When a user specified spheroid is used (code 101) then information about
is stored in two REAL_*8 (double precision) numbers.  The first of these
is the length of the semi-major axis; the second contains one of:- 
.B
1) the length of the semi-minor axis (in the same units), or
.BR
2) the eccentricity squared
.B
If the second number is 0.0 then a sphere is defined.
.NOTE NOTES
1) The eccentricity squared is defined as:-
.C;e_*_*2 = (a_*_*2-b_*_*2)/a_*_*2
where a is the semi-major axis and b is the semi-minor axis.
.B
2) This system works because e_*_*2 is less than 1.0, while the
semi-minor axis is usually greater than 1.0. 
.BR
If it is required to define a spheroid where the semi-minor axis is less
than 1.0 (e_.g_. a spheroid with a semi-major axis of 1.0) then the
second number must contain the eccentricity squared. 
.END NOTE
.LE;The projection that the data are on.
.B
.INDEX ITRANS> supported projections
The projections that ITRANS can work with (and their codes) are:
.LEFT MARGIN +5
.NOFILL
   0  Unset
   1  Universal Transverse Mercator
   2  State Plane Coordinates
   3  Albers Conical Equal Area
   4  Lambert Conformal Conic
   5  Mercator
   6  Polar Stereographic 
   7  Polyconic
   8  Equidistant Conic
   9  Transverse Mercator
  10_* Stereographic
  11_* Lambert Azimuthal Equal Area
  12_* Azimuthal Equidistant
  13_* Gnomonic
  14_* Orthographic
  15_* General Vertical Near-Side Perspective
  16_* Sinusoidal
  17_* Equirectangular
  18_* Miller Cylindrical
  19_* Van der Grinten
  20  Oblique Mercator (Hotine)
  21_* Oblique Mercator (Spherical)
  22  Stereographic (UKSL formulae)
  23  Cassini
  24  Krovak
  25  Bonne
  26_* Mollweide
  27_* Hammer-Aitoff
  28_* Winkel III
  29_* Modified-Stereographic
 100  Geographic  (ie. Latitude and Longitude)
 101  UK national grid  (a special case of 9)
.LEFT MARGIN -5
.FILL
.NOTE NOTES
1) Those projections marked with a '_*' are only defined for a sphere, not a 
spheroid
.B
2) Data can be held in spheroidal, or spherical, coordinates (i_.e_. Latitude
and Longitude) by specifying projection code 100 
.END NOTE
.B
The projections listed above specify the formulae to be used in the projection,
but in any particular case more data will be required, so there is provision in 
the map descriptor to store up to 15 additional pieces of data as REAL_*8
(double precision) numbers.
.B
.INDEX ITRANS> supported projections
.ENTRY ITRANS> supported projections> see Appendix A
See Appendix B for data about the individual projections.
.LE; The units that the data represent.
.B
When the data in the IFF file represents geographical coordinates
(projection code 100) then the numbers in the IFF file can represent
radians, seconds of arc, degrees of arc or 1/10's of seconds of arc. 
.B
As explained in (iii) above, the units of a projection are the units
used to define the spheroid, thus for all the spheroids that are
predefined in ITRANS the projection units are international metres, and
these are the units that are used for the projection calculations.  For
these spheroids ITRANS will allow data on the projections to be stored
and manipulated in feet (see below), but for user defined spheroids then
the only units that can be used on a projection are the original
projection units. 
.B
It is possible that the coordinates in an IFF file are in some other
units (e_.g_. mm on the table).  As explained, before doing any
^*projection\* calculations these units must be converted to projection
units and this is achieved by doing an empirical transformation. 
.B
In this case ITRANS will ask the operator for values of the control
points in projection units before doing the projection calculations. 
.B
.INDEX ITRANS> supported measurement units
.TP 12
In summary, the possible units in IFF files, and their codes which are
stored as an integer in the map descriptor, are:- 
.NOFILL
.LEFT MARGIN +5
  0 Unset
  1 Feet (assuming projection units are metres - see note
    below)
  2 Projection units (i_.e_. units used to specify spheroid).
    These will be International metres, except for 
    user-specified spheroids.
  3 Seconds of arc (only valid if projection is 100)
  4 Degrees of arc (only valid if projection is 100)
  5 Radians        (only valid if projection is 100)
101 mm on table (digitising scale)
102 mm on map sheet (source scale)
103 thousands of an inch on table (digitising scale)
104 thousands of an inch on map sheet (source scale)
105 user specified units
110 1/10 seconds of arc (only valid if projection is 100)
.FILL
.LEFT MARGIN -5
.NOTE NOTES
1) For projection 2, 1 foot = 0.304800610m (1m#=#39.37" exactly)
for all other projections, 1 foot = 0.3048m exactly
.B
2) Units 102 can be converted to projection units
by dividing by 1000 and multiplying by the scale. On output, projection
units may be converted to units 101 (table mm) in the same way.
.B
3) Units 104 can be converted to projection units by dividing by
39370.08 and multiplying by the scale. On output, projection units may
be converted to units 103 (table thou) in the same way. 

.B
4) User units (code 105) can only be output as a result of an empirical 
transformation. As they are linear (not angular) units, they cannot
be used in conjunction with geographicals (projection code 100).
.END NOTE
.END LIST
.TP 10
.LE;^*Carrying out projection transformations.\*
.INDEX ITRANS> DESCRIPTION> Carrying out projection transformations
.INDEX ITRANS> projection transformations
.INDEX ITRANS> carrying out projection transformations
.B
To transform data from one projection system into another, ITRANS uses
data from the map descriptor for the current IFF file and a map
descriptor for the target projection.  If the current IFF file has a
complete version 2 map descriptor then this will be used, but if it is
either not a version 2 type or it is not complete (e_.g_. the projection
code or unit code are set to 0) then the user will be asked to enter the
required data by a series of prompts. 
.NOTE
.INDEX LAT-LONG and ITRANS
.INDEX ITRANS> and Lat-Long coordinates
^*Within IFF files, coordinate data is stored as X Y coordinate pairs. 
This is the case even when geographical coordinates are held; ie
geographical coordinates are held as Longitude and Latitude\*. 
.B
If data has come from some non Laser-scan source, it is possible that
geographical coordinates are in the order Latitude Longitude, and to
allow for this possibility there is a flag in the map descriptor called
MD2FLP, which can be set by the conversion program. If this flag is set
TRUE, and the data is in geographical coordinates, ITRANS asks if the
coordinates are in the order Latitude Longitude.  If they are, ITRANS
converts them to Longitude Latitude. 
.B
Note that if ITRANS is being used to patch the map descriptor
(/DESCRIPTOR), this procedure will produce a new copy of the file with
all the coordinates in the order Longitude Latitude, even in cases when
normally the changes take place in situ. 
.B
ITRANS always clears MD2FLP.
.END NOTE
.B
If the unit code in the current map descriptor represents some
non-angular, non-projection unit (i_.e_. code 101-105) then ITRANS will
do an empirical transformation on the data before doing the projection
calculation.  This will be a "2 point" transformation. If another
empirical transformation is required, then this must be done in a
preprocessing run of ITRANS. See below for details of other empirical
transformations. 
.B
The target map descriptor is set up by the operator responding to the
relevant prompts. 
.B
When prompting for information, ITRANS tries to provide sensible default
values either from the existing map descriptor or from the context of
the prompt and these can be accepted by simply pressing _<CR_>. 
.B
Help on all but the most trivial of prompts can be obtained by replying
with a "?".  When run with the /LEARNER qualifier, ITRANS will output
the help information automatically before asking the question. 
.B
Replying with <CTRL/Z> to the first prompt for a map descriptor will
terminate the program; using it in reply to other prompts allows the
user to re-enter the last few values. 
.B
See Appendix C for allowable number formats to be used when replying to
prompts. 
.TP 10
.LE;^*Carrying out datum shifts.\*
.INDEX ITRANS> DESCRIPTION> Carrying out datum shifts
.INDEX ITRANS> datum shifts
.INDEX ITRANS> carrying out datum shifts
.INDEX ITRANS> geodetic datum
.INDEX ITRANS> command qualifiers> /DATUM__SHIFT
.B
When data is surveyed it is captured relative to some geodetic datum.
One part of this datum is the spheroid used, which has been discussed
above. The other part is the orientation of the spheroid relative to the
earth. This is called the origin of the geodetic datum. 
.BL
.INDEX ITRANS> geodetic datum> origin
The spheroid has 7 degrees of freedom, three defining the position of
its centre in relation (say) to the earth's centre of gravity (or any
other earth fixed point), three defining rotations about three
mutually perpendicular axes to orient it in any desired way and scale
to define its size.
.BL
In practice, all geodetic datums are defined such that the minor axes
are parallel, so there are only 5 freedoms used to define the location
of the spheroid in space. These are often called the origin of the
geodetic datum and can be expressed as the cartesian coordinates X, Y
and Z of the centre of the spheroid, the rotation about the minor (or Z)
axis and  the size (or scale) of the spheroid. This rotation is often
0.0, and when present is always very small (much less than 1 degree). 
.BL
ITRANS is only concerned with changes of datum, so only the differences
in these values are required i.e_. DX, DY, DZ, RZ and SF for the
differences in X, Y and Z, the rotation about the Z axis and the
difference in scale of the second spheroid with respect to the first.
These values are not stored in the map descriptor, but are prompted for
when required. 
.BL 2
ITRANS can be used to convert data from one geodetic datum to another by
using the /DATUM__SHIFT qualifier. It is only possible to carry out this
conversion if the input (and output) data are in geographical
coordinates (i.e_. projection type 100 - Latitude and Longitude).
.BL
ITRANS does this conversion by:
.LIST
.LE; converting the Latitude, Longitude and Height of the point on the
spheroid of the first geodetic datum to cartesian coordinates (X, Y and
Z) relative to the spheroid's centre. 
.LE; applying the differences between the datums (DX, DY, DZ, RZ and SF)
to these coordinates to convert them to the new datum. The user is
prompted for these values. 
.NOTE
The values of these parameters will generally be obtained from published
tables or directly from Geodetic Departments, and care must be taken to
ensure that the values so obtained are in the same sense as ITRANS
expects them.
.LIST
.LE; The scale factor is generally expressed in "parts per million" and
this is the form in which ITRANS expects the value to be entered. For
example the scale factor between WGS72 and WGS84 is approximately +0.23
ppm. (This implies a scale factor of 1.00000023 in the formulae below.) 
.LE; The rotation about the Z axis assumes a right angled coordinate
system, where anticlockwise angles are considered positive, and the
solid is considered to rotate relative to the axes. For example, again
taking the datum shift from WGS72 to WGS84, the required angle is
+0.554". 
.BL
^*PLEASE NOTE THAT THERE HAS BEEN CONSIDERABLE CONFUSION ABOUT THE SENSE 
OF THIS ANGLE IN PUBLISHED ARTICLES.\* If there is any doubt about it 
apply Jensen's law - "If the correction is small, don't apply it as you 
will surely apply it the wrong way".
.BL
.END LIST
.TP 10
A standard 3 dimensional conformal transformation (assuming small
rotations) is used. Rotations about the X and Y axes are 0.0. This
gives: 
.LITERAL

      | X |     = | DX |   + SF | 1  -RZ  0 |  | X |
      | Y |       | DY |        | RZ  1   0 |  | Y |
      | Z |new    | DZ |        | 0   0   1 |  | Z | old

.END LITERAL
.END NOTE
.LE; converting the new cartesian X, Y and Z to Latitude, Longitude
and Height on the spheroid for the second datum. This will usually
be a different spheroid from the original datum, so this is the only
mode in which ITRANS allows the user to input the output spheroid.
.END LIST
.TP10
When converting most map data, it is adequate to assume that the points
lie on the spheroid (and thus have a height of 0.0). This is the default
mode of operation and as with projection calculations the Z values in
ZS or CB entries are just carried through to the output (i.e_. only their
Latitude and Longitude are altered).
.BL
In the general case, however, the height of a point can
be significant in the above calculations. This situation can be
accomodated in ITRANS by the use of the /HEIGHT__ADJUST qualifier in
conjunction with /DATUM__SHIFT.
.INDEX ITRANS> command qualifiers> /DATUM__SHIFT
However, this introduces another complication in that heights are
measured above the geoid (or mean sea level), while 
the above calculation uses the height above the spheroid. This
geoid-spheroid separation is required for both datums and must be
entered by the operator. The entered value for the input datum is added
to the height before converting to cartesian coordinates in 1) above,
and the value for the target datum is subtracted from the height after
converting to geographicals in 3). It is assumed that the geoid-spheroid
separation is constant over the area of the map.
.BL
When using the /HEIGHT__ADJUST qualifier, as well as the height of the
points affecting the position (latitude and longitude) of the points,
the height is also output relative to the new datum.
.NOTE
In IFF files this is only the case if the height is held as an attribute
of a ^*point\* (i.e_. in a ZS or CB entry). When the height is held as
the attribute if a ^*feature\* (i.e_. as an AC entry) the feature is
converted as though it lay on the spheroid, and the value of the AC is
unaffected. 
.END NOTE
^*
.NOTE ^&WARNING\&
While the above gives a general mechanism for conversion of
spheroid/geodetic datum, it should be noted that "real" survey data often
contains errors that render it unsuitable to the above approach.
For example, in the United Kingdom the National Grid is based on the
OSGB36 datum, which is an inhomogeneous system unsuitable for the above
conformal approach.
.BL
This mode of ITRANS should be used with care and
where possible it is recommended that the results that it produces
are verified on known points, before mass data conversions are carried
out. This is particularly true when using the /HEIGHT__ADJUST qualifier.
.END NOTE
\*
.TP 10
.LE;^*Carrying out empirical transformations.\*
.INDEX ITRANS> DESCRIPTION> Carrying out empirical transformations
.INDEX ITRANS> empirical transformations
The situation often arises that data must be transformed from one
coordinate space to another, when the mathematical relationships between
these spaces are not known, but the coordinates of common points in both
systems are available.
.B
ITRANS provides 5 sets of transformation formulae that may used for
these transformations, and the ability to use the coordinates of the
common points to determine the values of the coefficients to be used in
a particular case. If there are more than the minimum required number of
common points, then the best solution is found using the "principle of
least squares".
.NOTE Important Notes.
.LIST
.LE;A least squares solution is only valid if the errors that it is
required to distribute are ^&random\&. If there are systematic errors or
the input data is wrong, then the solution obtained is of no value.
.LE;Systematic errors may be allowed for by choosing a suitable set of
transformation formulae. It is preferable if this choice can be made
based on a knowledge of the distortions, rather than empirically.
.LE;The control points must be distributed so that they adequately
define the relationship between the two coordinate spaces as specified
by the formulae chosen. For example, points in a straight line are not
suitable for most formulae, except perhaps the orthogonal
transformation.
.LE;These empirical transformations are designed for "local" fitting.
They operate best if the two coordinate spaces are of a similar
magnitude and any large constant values in the coordinates are first
removed (either by a run of ITRANS to move them to the origin offset if
they exist in the input space, and by avoiding the use of the /ABS
qualifier, to ensure that any constant is put in the origin offset on
output).
.B
Ideally the range of the control points should be greater than, say, 10%
of the average coordinate values.
.END LIST
.END NOTE
When carrying out these empirical transformations on data in an IFF file
ITRANS uses one of:
.LIST
.LE;the data in the left hand (or "original") side of the CP entry along
with one of: 
.LIST 'o'
.LE;the data in the right hand (or "target") side of the CP entry, or 
.LE;four pairs of coordinates entered by the user, or
.LE;the data in the right hand (or "target") side of the CP entry added
to the origin offset and scaled up to projection units (by multiplying
by the scale factor an dividing by 1000.0 for mm or 39370.08 for
thousands of an inch).
.BL
This is only available if the input data is in mm on map sheet (unit
code 102) or thousands of an inch on map sheet (unit code 104) and a
projection calculation is being carried out. The data is displayed and
the user is given the option of accepting these scaled up values or
using one of the other options.
.END LIST
.LE;a file containing the original and target control points, this is 
defined by the /CONTROL qualifier.  A description of the file appears under
/CONTROL in the command qualifiers section.
.END LIST
.B
.TP 10
There are five transformations that can be carried out by ITRANS.
These are: 
.LIST
.LE; If the /FOUR qualifier is given then ITRANS uses a least squares fit
of the sets of coordinates to compute the transformation
.B
.C;X = a1 + a2_*x + a3_*y + a4_*x_*y
.C;Y = b1 + b2_*x + b3_*y + b4_*x_*y
.B
This transformation requires a minimum of 4 control points.
.B
This transformation will force the minimum 4 input points to fit the
output points exactly; other points in the file suffer a "saddle" 
distortion. It is thought to be useful for correcting paper distortion,
as when data is digitised from a paper map based on known exact control
points such as  graticule intersections. 
.B
This transformation is called the "Extended four point" transformation
in other Laser-Scan programs.
.NOTE
This transformation breaks down if a rotation of exactly 45 degrees,
a scale change and a shift are the only differences between the input
points and the output points. In this case /TWO or /THREE will give
the required results.
.B
This is a case of badly distributed control points.
.END NOTE

.TP 8
.LE; The /PROJECTIVE qualifier uses a least squares fit of the sets of
coordinates to compute the transformation 
.B
.C;X = (a1_*x + a2_*y + a3) / (a7_*x + a8_*y +1)
.C;Y = (a4_*x + a5_*y + a6) / (a7_*x + a8_*y +1)
.B
This transformation requires a minimum of 4 control points.
.B
This transformation uses a projective algorithm and will force
4 input points to fit the output points exactly. It tends to fit the
outside edges of the area, while points in the middle are moved more
than with the other formulae.

.TP 8
.LE; If the /SIX qualifier is given then ITRANS uses a least squares fit
of the sets of coordinates to compute the transformation
.B
.C;X = a1 + a2_*x + a3_*y + a4_*x_*y + a5_*x_*x + a6_*y_*y
.C;Y = b1 + b2_*x + b3_*y + b4_*x_*y + b5_*x_*x + b6_*y_*y
.B
This transformation requires a minimum of 6 control points, and can thus
only be used in conjunction with the /CONTROL qualifier.
.B
This transformation is known as the "general second order" or
"quadratic" transformation.

.TP 8
.LE; The /THREE qualifier uses a least squares fit of the sets of 
coordinates to compute the transformation 
.B
.C;X = a1 + a2_*x + a3_*y
.C;Y = b1 + b2_*x + b3_*y
.B
This transformation requires a minimum of 3 control points.
.B
This transformation is sufficient to correct for rotation, scaling,
translation and shearing.  This means that shapes may be altered, but in
a predictable way (e_.g_. a square may be transformed into a
parallelogram).
.B
This transformation is also known as the "Affine" transformation.
.TP 8
.LE; The /TWO qualifier uses a least squares fit of the sets of 
coordinates to compute the transformation
.B
.C;X = a1 + a2_*x - a3_*y
.C;Y = a4 + a3_*x + a2_*y
.B
This transformation requires a minimum of 2 control points.
.B
This transformation is sufficient to correct for rotation, scaling and
translation only. This means that the shapes of features will not be
altered and is the transformation that is used by default. 
.B
This transformation is called the "Orthogonal" transformation
in other Laser-Scan programs. It is also known as the "Helmert"
transformation.
.END LIST

When more than the minimum number of control points are supplied to the
above formulae, a least squares solution is applied to resolve the
inevitable ambiguities. This means that the final coordinates of the
control points may be slightly different from the target values.  Where
the maximum of these discrepancies is greater than 1/1000th of the range
of the target control point values then the operator is asked if the
transformation is to be accepted. 
.B
By default, when doing an empirical transformation, the target coordinates
are all reduced by the minimum of their values in x and y, and this
value is used as the local origin of the current data.  This ensures
that all the points will be positive, and it will also, usually, reduce
their absolute size.  If it is required to transform a file onto
particular values (with no offset) then the /ABSOLUTE qualifier should
be used. The use of this qualifier is not recommended, except in
exceptional circumstances (e_.g_. when it is desired to further reduce
the size of the coordinates in the output space by choosing the "centre
of gravity" of the output coordinates as the origin). It is preferable
to use a subsequent run of ITRANS to apply the origin offset to the
coordinates in the IFF file.
.B
ITRANS carries out empirical transformations in two circumstances:
.LIST
.LE; When a projection calculation is being carried out and the input
data is in table, sheet or user units (units code 101-105) then the user
is forced to do a empirical transformation before the projection
calculation.  This will be a two point transformation and in this case
the output units cannot be user units. 
.LE; When ITRANS is run with the /TWO, /THREE, /SIX, /FOUR or /PROJECTIVE
qualifiers then the corresponding transformation is carried out on
the data. 
.B
Any scalar output units can be specified; their dimensions are taken
from the target control points. 
.B
 In this case it is not possible to combine the empirical transformation with
projection calculations. 
.END LIST
.NOTE
If a projection calculation is required, and the input data is in table,
sheet or user units anything but an orthogonal transformation is
required on the data, then two runs of ITRANS will be required. The
first to transform the data into projection units (using the appropriate
formulae) and the second to do the projection calculation. 
.END NOTE
.B
See Appendix C for allowable number formats to be used when replying to
prompts. 
.TP 10
.LE;^*Carrying out projection and datum shift calculations on individual
points.\* 
.INDEX ITRANS> DESCRIPTION> projection calculations on individual points 
.INDEX ITRANS> DESCRIPTION> datum shift calculations on individual points
.INDEX ITRANS> projection calculations on individual points
.INDEX ITRANS> datum shift calculations on individual points
.B
To transform individual points from one projection to another use ITRANS
with the /POINT qualifier. 
.B
The operator will be asked to enter data about the input projection
system and the target projection system.
.B
When this has been achieved, the user is asked to input points in the
first system, in the appropriate units and these will be converted to
the target system and displayed. 
.B
When using the /POINT descriptor on geographical coordinates (either as
input or output) it is possible to specify unit code 200.  This allows
angular values to be read/written in the format DDD MM SS.SSS. 
.B
An ASCII file of X and Y coordinate pairs can be read by giving the
command "@filename" to the prompt asking for the coordinates of a point 
to convert.
Missing parts of the file-spec are taken from the default specification 
SYS$DISK:ITRANS_.DAT.
.B
See Appendix C for allowable number formats to be used when replying to
prompts. 
.B
Use <CTRL/Z> to exit from the program.
.TP 10
.LE;^*Editing the map descriptor.\*
.INDEX ITRANS> Editing the map descriptor
.B
Use ITRANS with the /DESCRIPTOR qualifier to edit an existing version 2
map descriptor or to insert one in a file that has an old type.
.NOTE WARNING
In the first case, the entry is patched into the existing IFF file, so a copy 
of the file should be taken before use.
.B
In the second case a new version of the file is created.
.END NOTE
The operator is prompted to enter the various fields of the map descriptor.
.END LIST
.!
.LEFT MARGIN -7
.PAGE
^*--------------------------------------------------------------------------------\*
.INDEX ITRANS> EXAMPLES
.HL 2 ^*EXAMPLES\*
.NOFILL
.FLAGS BOLD
.BLANK 3
$ ^*ITRANS EXAMPLE EXGEOG_<CR_>\*
%ITRANS-W-NOV2MD, map descriptor in 'DUA0:[IFF.IMP.ITRANS]EXAMPLE.IFF;1' is not version 2
 
Enter projection data for current IFF file
.LIT
******************************************
.END LIT
 
Enter spheroid code (0): ^*9_<CR_>\*
                         (Airy)
 
Enter projection code (100): ^*101_<CR_>\*
                             (UK national grid)
 
Enter scale of map (0.0): ^*2500_<CR_>\*
 
Enter unit code (2):   ^*_<CR_>\*
                     (metres)
 
Define local origin as Eastings and Northings (0.0  0.0): ^*599000 499000_<CR_>\*
 
Enter projection data for target IFF file
.LIT
*****************************************
.END LIT
 
Using spheroid :   9 (Airy)
 
Enter projection code (101): ^*100_<CR_>\*
                             (Geographic  (ie Lat and Long))
 
Enter scale of map (2500.0): ^*_<CR_>\*
 
Enter unit code (5): ^*?_<CR_>\*
 
Allowable Units and their codes are:-
 
  0 Unset                               1 feet                            
  2 metres                              3 seconds of arc                  
  4 degrees of arc                      5 radians                         
101 mm on table                      102 mm on map sheet                
103 thous (mils) on table             104 thous (mils) on map sheet       
105 user units                        110 1/10 seconds of arc             
 
Enter unit code (5): ^*4_<CR_>\*
                     (degrees of arc)
 
Define local origin as Latitude and Longitude (54.347  1.062): ^*_<CR_>\*
Longitude (1.062): ^*_<CR_>\*
 
Input projection system
.LIT
***********************
.END LIT
 
Spheroid     :   9 (Airy)
Projection   : 101 (UK national grid)
 
Scale        :        2500.0
Units        :   2 (metres)
Local origin :      599000.000 (Eastings)     499000.000 (Northings)
 
Output projection system
.LIT
************************
.END LIT
 
Spheroid     :   9 (Airy)
Projection   : 100 (Geographic  (ie Lat and Long))
 
Scale        :        2500.0
Units        :   4 (degrees of arc)
Local origin :           54.347 (Latitude)        1.062 (Longitude)
 ELAPSED: 00:00:47.89  CPU: 0:00:05.67  BUFIO: 68  DIRIO: 55  FAULTS: 108 
$
.LEFT MARGIN +10
.FILL
.BLANK 4
In this example ITRANS is used to transform the IFF file EXAMPLE (which is held 
in metres on the UK national grid) into geographicals in a file called EXGEOG.
.B
As EXAMPLE does not have a valid version 2 map descriptor, the user is first 
asked to enter its projection data. Projection 101 (UK national grid) does not 
require any additional information.
.B
The user is next asked to enter data for the target projection. Projection 100 
(geographicals) also does not required any additional information.
.B
In reply to the prompt "Enter unit code", the user has entered "?", so a list 
of possible units codes has been output.
.B
As the /OUTPUT qualifier has not been given, the record of the transformation 
is output to SYS$OUTPUT
.B
The program finishes by outputting timing statistics. $STATUS is set to
SS$__NORMAL.

.NOFILL
.LEFT MARGIN -10
.PAGE
$ ^*ITRANS/LOG/OUTPUT EXGEOG EXMERC_<CR_>\*
%LSLLIB-I-IFFOPENED, DUA0:[IFF.IMP.ITRANS]EXGEOG.IFF;1 opened for read

Existing map descriptor:
 
 
Spheroid     :   9 (Airy)
Projection   : 100 (Geographic  (ie Lat and Long))
 
Scale        :        2500.0
Units        :   4 (degrees of arc)
Local origin :           54.347 (Latitude)        1.062 (Longitude)
 
Enter projection data for target IFF file
.LIT
*****************************************
.END LIT
 
Using spheroid :   9 (Airy)
 
Enter projection code (100): ^*5_<CR_>\*
                             (Mercator)

The Mercator projection requires the following
additional information:-

   Latitude that has true scale
   in DDD MM SS.SS format (  0 00 00.000N): ^*49N_<CR_>\*
   Longitude of the central meridian
   in DDD MM SS.SS format (  0 00 00.000E): ^*2W_<CR_>\*
   Eastings of the origin of the projection (0.0): ^*_<CR_>\*
   Northings of the origin of the projection (0.0): ^*_<CR_>\*
 
Enter scale of map (2500.0):  ^*_<CR_>\*

Enter unit code (2): ^*_<CR_>\*
                     (metres)
 
Define local origin as Eastings and Northings (224044.019  4733264.099): ^*_<CR_>\*
Northings (4733264.099):  ^*_<CR_>\*
%LSLLIB-I-IFFOPENED, DUA0:[IFF.IMP.ITRANS]EXMERC.IFF;1 opened for write
 ELAPSED: 00:00:40.70  CPU: 0:00:04.43  BUFIO: 45  DIRIO: 69  FAULTS: 280 
$
.LEFT MARGIN +10
.FILL
.BLANK 4
In this example ITRANS is used to transform the IFF file EXGEOG (created in the 
last example) into a mercator projection in a file called EXMERC.IFF. 
.B
As the /LOG qualifier has been given, a message is given whenever files are 
opened.
.B
As the input file has a valid map descriptor the user is only asked to enter 
data for the target projection. Sensible values are offered as defaults.
.B
The Mercator projection requires four additional pieces of information.  As the 
input projection is different from the target system, defaults of 0.0 are 
offered.
.B
As the target system is a projection, the default units are projection units.
.B
The local origin of the input system is transformed into the target system and 
is offered as a default.
.NOFILL
.LEFT MARGIN -10
.TP 15

$ ^*ITRANS/POINT_<CR_>\*
 
Enter projection data for source system
.LIT
***************************************
.END LIT
 
Enter spheroid code (0): ^*_<CTRL/Z>\*
%ITRANS-W-EOF, program terminated prematurely by '_^Z'
 ELAPSED: 00:00:03.19  CPU: 0:00:00.34  BUFIO: 6  DIRIO: 0  FAULTS: 135 
.B4
.FILL
.LEFT MARGIN +10
In this example ITRANS is to be used to transform individual points.
.B
The run is terminated prematurely by entering _<CTRL/Z_> to the first prompt.
.LEFT MARGIN -10
.TP 15
.NOFILL

$ ^*ITRANS/POINT/OUTPUT=EXPOINT_<CR_>\*
 
Enter projection data for source system
.LIT
***************************************
.END LIT
 
Enter spheroid code (0): ^*9_<CR_>\*
                         (Airy)
 
Enter projection code (100): ^*101_<CR_>\*
                             (UK national grid)
 
Enter unit code (2):  ^*_<CR_>\*
                     (metres)
 
Enter projection data for target system
.LIT
***************************************
.END LIT
 
Using spheroid :   9 (Airy)
 
Enter projection code (101): ^*5_<CR_>\*
                             (Mercator)

The Mercator projection requires the following
additional information:-

   Latitude that has true scale
   in DDD MM SS.SS format (  0 00 00.000N): ^*49N_<CR_>\*
   Longitude of the central meridian
   in DDD MM SS.SS format (  0 00 00.000E): ^*2W_<CR_>\*
   Eastings of the origin of the projection (0.0): ^*_<CR_>\*
   Northings of the origin of the projection (0.0): ^*_<CR_>\*
 
Enter unit code (2): ^*_<CR_>\*
                     (metres)
 
Eastings and Northings: ^*599000 500000_<CR_>\*
Transformed point    224092.895     4734388.290
 
Eastings and Northings: ^*599000 499000_<CR_>\*
Transformed point    224044.019     4733264.099
 
Eastings and Northings: ^*600000 499000_<CR_>\*
Transformed point    225168.075     4733215.114
 
Eastings and Northings: ^*600000 500000_<CR_>\*
Transformed point    225217.195     4734339.279
 
Eastings and Northings: ^*_<CTRL/Z>\*
 ELAPSED: 00:00:45.68  CPU: 0:00:00.84  BUFIO: 50  DIRIO: 15  FAULTS: 145 
$
.FILL
.BLANK 4
.LEFT MARGIN +10
In this example ITRANS is used to convert individual points from UK National 
Grid to a Mercator projection.
.B
As the /OUTPUT qualifier has been given, the file EXPOINT.LIS has been created.
This contains the following:-
.NOFILL
.LEFT MARGIN -10
.BLANK 4
================================== ITRANS ======================================


ITRANS invoked by TIM using terminal LTA75: at  9-NOV-1986 08:52:29.05
 
Command line:
ITRANS/POINT/OUTPUT=EXPOINT

 
Input projection system
.LIT
***********************
.END LIT
 
Spheroid     :   9 (Airy)
Projection   : 101 (UK national grid)
 
Units        :   2 (metres)
 
Output projection system
.LIT
************************
.END LIT
 
Spheroid     :   9 (Airy)
Projection   :   5 (Mercator)
 
   Latitude of true scale                       :   49 00 00.000N
   Longitude of the central meridian            :    2 00 00.000W
   Eastings  of origin                          :           0.000
   Northings of origin                          :           0.000
 
Units        :   2 (metres)


.TP 12
Transformed points
.LIT
******************
.END LIT

             Input  Point                            Output Point

    Easting           Northing              Easting           Northing          

   599000.000        500000.000           224092.895       4734388.290
   599000.000        499000.000           224044.019       4733264.099
   600000.000        499000.000           225168.075       4733215.114
   600000.000        500000.000           225217.195       4734339.279
.BLANK 2
.TP 15
$ ^*ITRANS/DESCR/OUTPUT=EXDESC/LOG EXMERC_<CR_>\*
%LSLLIB-I-IFFOPENED, DUA0:[IFF.IMP.ITRANS]EXMERC.IFF;1 opened for read

Existing map descriptor:
 
 
Spheroid     :   9 (Airy)
Projection   :   5 (Mercator)
 
   Latitude of true scale                       :   49 00 00.000N
   Longitude of the central meridian            :    2 00 00.000W
   Eastings  of origin                          :           0.000
   Northings of origin                          :           0.000
 
Scale        :        2500.0
Units        :   2 (metres)
Local origin :      224044.019 (Eastings)    4733264.099 (Northings)
 
Enter projection data for current IFF file
.LIT
******************************************
.END LIT
 
Enter spheroid code (9): ^*_<CR_>\*
                         (Airy)
 
Enter projection code (5): ^*_<CR_>\*
                           (Mercator)

The Mercator projection requires the following
additional information:-

   Latitude that has true scale
   in DDD MM SS.SS format ( 49 00 00.000N): ^*_<CR_>\*
   Longitude of the central meridian
   in DDD MM SS.SS format (  2 00 00.000W): ^*_<CR_>\*
   Eastings of the origin of the projection (0.0): ^*_<CR_>\*
   Northings of the origin of the projection (0.0): ^*_<CR_>\*
 
Enter scale of map (2500.0): ^*_<CR_>\*
 
Enter unit code (2): ^*105_<CR_>\*
                     (user units)
 
Define local origin as Eastings and Northings (224044.019  4733264.099): ^*0_<CR_>\*
Northings (4733264.099): ^*0_<CR_>\*
%LSLLIB-I-IFFOPENED, DUA0:[IFF.IMP.ITRANS]EXMERC.IFF;1 opened for update
%ITRANS-I-MDPTCHED, MD entry patched into 'DUA0:[IFF.IMP.ITRANS]EXMERC.IFF;1'
 ELAPSED: 00:00:26.64  CPU: 0:00:01.15  BUFIO: 52  DIRIO: 25  FAULTS: 165 
.BLANK 4
.FILL
.LEFT MARGIN +10
In this example ITRANS is used to alter the unit code in the map descriptor of 
the file EXMERC.IFF without doing any transformation.
.B
As the file has a valid version 2 map descriptor, the MD entry is patched
in situ. 
.NOFILL
.LEFT MARGIN -10
.B4
$ ^*ITRANS/OUTPUT/LOG EXMERC EXAMPLE1_<CR_>\*
%LSLLIB-I-IFFOPENED, DUA0:[IFF.IMP.ITRANS]EXMERC.IFF;1 opened for read

Existing map descriptor:
 
 
Spheroid     :   9 (Airy)
Projection   :   5 (Mercator)
 
   Latitude of true scale                       :   49 00 00.000N
   Longitude of the central meridian            :    2 00 00.000W
   Eastings  of origin                          :           0.000
   Northings of origin                          :           0.000
 
Scale        :        2500.0
Units        : 105 (user units)
Local origin :           0.000 (Eastings)          0.000 (Northings)
 
Data are not in projection units
Existing control points are:
            48.876       1124.191
             0.000          0.000
          1124.056        -48.985
          1173.176       1075.180
Do you wish to use these control points [N]? ^*N_<CR_>\*
Enter control point values in metres on Mercator projection
Enter coordinates of NW corner:  ^*224092.90 4734388.29\*
Enter coordinates of SW corner: ^* 224044.02 4733264.10\*
Enter coordinates of SE corner: ^* 225168.08 4733215.11\*
Enter coordinates of NE corner: ^* 225217.20 4734339.28\*
 
Enter projection data for target IFF file
.LIT
*****************************************
.END LIT
 
Using spheroid :   9 (Airy)
 
Enter projection code (5): ^*101_<CR_>\*
                           (UK national grid)
 
Enter scale of map (2500.0): ^*_<CR_>\*
 
Enter unit code (2): ^*_<CR_>\*
                     (metres)
 
Define local origin as Eastings and Northings (599001.892  498956.5): ^*599000 499000_<CR_>\*
%LSLLIB-I-IFFOPENED, DUA0:[IFF.IMP.ITRANS]EXAMPLE1.IFF;1 opened for write
 ELAPSED: 00:02:07.74  CPU: 0:00:08.42  BUFIO: 52  DIRIO: 72  FAULTS: 272 
.BLANK 4
.FILL
.LEFT MARGIN +10
In this example ITRANS is used to convert EXMERC back into UK national grid.
.B
As the units in the input file are not in projection units, the user is 
required to set up data for a two point transformation, before the projection 
calculation can be carried out.
.B
The user chooses not to use the values in the right hand side of the existing
CP entry, but enters full Mercator coordinates for each control point. As the
/ABS qualifier has not been given, these values are reduced by their minimum x
and y values to produce smaller absolute values, and this minimum x and y is
used as the local origin. 
.B
This point is then transformed and offered as the default local origin for the 
target system, but is not accepted.
.B
As the /OUTPUT qualifier has been given, the file ITRANS.LIS has been created.
Note that as a 2 point empirical transformation has been used, there are small 
discrepancies between the target values of the control points and their final 
values.
.NOFILL
.LEFT MARGIN -10
.BLANK 4
================================== ITRANS ======================================


ITRANS invoked by TIM using terminal LTA75: at  9-DEC-1986 09:12:29.05
 
Command line:
ITRANS/OUTPUT/LOG EXMERC EXAMPLE1
 
 
Input projection system
.LIT
***********************
.END LIT
 
Spheroid     :   9 (Airy)
Projection   :   5 (Mercator)
 
   Latitude of true scale                       :   49 00 00.000N
   Longitude of the central meridian            :    2 00 00.000W
   Eastings  of origin                          :           0.000
   Northings of origin                          :           0.000
 
Scale        :        2500.0
Units        : 105 (user units)
Local origin :           0.000  (Eastings)       0.000 (Northings)
 
Control points (from CP entry) used for 2 point transformation
.LIT
**************************************************************
.END LIT
 
            Input                      Target                     Final
 
      48.876     1124.191        48.880     1173.180        48.879     1173.182
       0.000        0.000         0.000       48.990         0.001       48.988
    1124.056      -48.985      1124.060        0.000      1124.059        0.002
    1173.176     1075.180      1173.180     1124.170      1173.181     1124.168
 
Default origin calculated as:      224044.020     4733215.110
 
 
Output projection system
.LIT
************************
.END LIT
 
Spheroid     :   9 (Airy)
Projection   : 101 (UK national grid)
 
Scale        :        2500.0
Units        :   2 (metres)
Local origin :      599000.000 (Eastings)     499000.000 (Northings)


Input file : DUA0:[IFF.IMP.ITRANS]EXMERC.IFF;1

Output file: DUA0:[IFF.IMP.ITRANS]EXAMPLE1.IFF;1


.NOFILL
.KEEP
.LEFT MARGIN 0

$ ^*itrans/point/datum/height_<CR_>\*
 
Enter projection data for source system
.LIT
***************************************
.END LIT
 
Enter spheroid code (0): ^*5_<CR_>\*
                         (World Geodetic System 72 (WGS 72))
Define Geoidal - spheroidal separation (0.0): ^*_<CR_>\*
 
Enter projection code (100): ^*_<CR_>\*
                             (Geographic  (ie Lat and Long))
 
Enter unit code (200): ^*_<CR_>\*
                       (dd mm ss.ss format)
 
Define shift in X from original datum to target datum (0.0): ^*0.0_<CR_>\*
Define shift in Y from original datum to target datum (0.0): ^*0.0_<CR_>\*
Define shift in Z from original datum to target datum (0.0): ^*4.5_<CR_>\*
Define rotation about Z axis of the target datum from the original
datum (in DDD MM SS.SS format) (+  0 00 00.000)       : ^*00 00 00.554_<CR_>\*
Define scale difference between datums (in ppm) (0.0) : ^*0.2263_<CR_>\*
 
Enter projection data for target system
.LIT
***************************************
.END LIT
 
Enter spheroid code (5): ^*22_<CR_>\*
                         (World Geodetic System 84 (WGS 84))
Define Geoidal - spheroidal separation (0.0): ^*_<CR_>\*
 
Enter projection code (100): ^*_<CR_>\*
                             (Geographic  (ie Lat and Long))
 
Enter unit code (200): ^*_<CR_>\*
                       (dd mm ss.ss format)
 
Input projection system
.LIT
***********************
.END LIT
 
Spheroid     :   5 (World Geodetic System 72 (WGS 72))
                   (with Geoid - Spheroid separation of 0.0)
Projection   : 100 (Geographic  (ie Lat and Long))
 
Units        : 200 (dd mm ss.ss format)
 
Parameters used for datum conversion
.LIT
************************************
.END LIT
 
  DX =      0.00
  DY =      0.00
  DZ =      4.50
  RZ = +  0 00 00.554
  SF =      0.23 (parts per million)
 
 
Output projection system
.LIT
************************
.END LIT
 
Spheroid     :  22 (World Geodetic System 84 (WGS 84))
                   (with Geoid - Spheroid separation of 0.0)
Projection   : 100 (Geographic  (ie Lat and Long))
 
Units        : 200 (dd mm ss.ss format)
 
Latitude, Longitude and Height: ^*39 13 26.5782n 98 32 32.2870w 570.88_<CR_>\*
Transformed point  39 13 26.698N     98 32 31.733W     573.25 
 
Latitude, Longitude and Height: ^*^Z\*
 ELAPSED:    0 00:02:07.87  CPU: 0:00:00.18  BUFIO: 66  DIRIO: 0  FAULTS: 147 
$

.BLANK 4
.FILL
.LEFT MARGIN +10
In this example ITRANS is used to do an accurate geodetic datum shift
between WGS72 and WGS84. 
.B
As the _/HEIGHT__ADJUST qualifier has been given, ITRANS prompts for the
spheroid geoid separation. In this case the heights of the points are
spheroidal heights, so the default value of 0.0 is used.
.B
Between defining the input and output systems, ITRANS prompts for the
shifts to be applied. Note that the rotation is given in degrees minutes
and seconds format. The scale change is given as parts per million. 
.B
As the _/HEIGHT__ADJUST qualifier has been given, ITRANS requires
latitude, longitude and height for each point to convert. 
.NOFILL
.LEFT MARGIN -10

.BL 4
                                                 
$ ^*ITRANS/FOUR/CONTROL=EXAMPLE RWR__GRID RWR__OUT_<CR_>\*

Existing map descriptor:


Spheroid     :   9 (Airy)
Projection   : 101 (UK national grid)

Scale        :        2500.0
Units        :   2 (metres)
Local origin :      499000.000 (Eastings)      599000.000 (Northings)
.LIT
%ITRANS_W_ERRCPTS, residuals in X and Y of 0.59 1.81 metres
.END LIT
Do you wish to continue with these residuals [N]? ^*Y\*

Default origin of current IFF file has been computed
as:               Easting 499000.000 Northing  599000.0

Enter projection data for target IFF file
.LIT
*****************************************
.END LIT

Using spheroid :   9 (Airy)

Using projection:  101 (UK national grid)

Enter unit code (105): ^*_<CR_>\*
                       (user units)

Define local origin as Eastings Northings (499000.0  599000.0): ^*_<CR_>\*
(599000.0)  ^*_<CR_>\*

Input projection system
.LIT
***********************
.END LIT

Spheroid     :   9 (Airy)
Projection   : 101 (UK national grid)

Scale        :        2500.0
Units        :   2 (metres)
Local origin :      499000.000 (Eastings)      599000.000 (Northings)

Control points (from command file) used for 4 point transformation
.LIT
******************************************************************
.END LIT
 
            Input                      Target                     Final
 
  499000.000   600000.000   499000.000   600000.000   498999.688   599999.375
  499000.000   599000.000   499000.000   599000.000   498999.826   598999.653
  500000.000   599000.000   500000.000   599000.000   499999.688   598999.375
  500000.000   600000.000   500002.500   600005.000   500002.049   600004.097
  499250.000   599500.000   499250.000   599500.000   499250.035   599500.069
  499750.000   599500.000   499750.000   599500.000   499750.590   599501.181
  499500.000   599250.000   499500.000   599250.000   499500.035   599250.069
  499500.000   599750.000   499500.000   599750.000   499500.590   599751.181
 
Default origin calculated as:      499000.000      599000.000
 

Output projection system
.LIT
************************
.END LIT

Spheroid     :   9 (Airy)
Projection   : 101 (UK national grid)

Scale        :        2500.0
Units        : 105 (user units)
Local origin :      499000.000 (Eastings)      599000.000 (Northings)
 ELAPSED:    0 00:00:39.71  CPU: 0:00:01.48  BUFIO: 67  DIRIO: 104  FAULTS: 218 

.FILL
In this example the /CONTROL qualifier has been given in conjunction
with  the /FOUR qualifier.  This has the effect of reading the control
points from a file, in this case called EXAMPLE.DAT (shown below), which
is held in the  current directory and performing a four point empirical
transformation using these control points.
.NOFILL
.B
!
! This is an example control point file
!
! The coordinates are absolute; ie they include the local origin
!
499000.000  600000.000	499000.000  600000.000
499000.000  599000.000	499000.000  599000.000
500000.000  599000.000	500000.000  599000.000
500000.000  600000.000	500002.500  600005.000	! this is only point in error
499250.000  599500.000	499250.000  599500.000
499750.000  599500.000	499750.000  599500.000
499500.000  599250.000	499500.000  599250.000
499500.000  599750.000 	499500.000  599750.000 
;
; and this is the end of it

.FILL

.KEEP
.LEFT MARGIN 0

.PAGE
^*--------------------------------------------------------------------------------\*
.HL 2 ^*MESSAGES (informational)\*
.B
These messages give information only, and require no immediate action from the 
user.
.LEFT MARGIN +4
.B
.I -4;MDCOPIED,  new version of IFF file created
.B
^*Explanation:\* When using ITRANS with the /DESCRIPTOR qualifier, the
specified IFF file did not have a version 2 map descriptor entry, so a
new IFF file has been created which has a MD entry of the correct
length. 
.B
^*User action:\* Delete the original IFF file on completion of this run
of ITRANS. 
.B
.I -4;MDPTCHED,  MD entry patched into IFF file
.B
^*Explanation:\* When using ITRANS with the /DESCRIPTOR qualifier, the
specified IFF file had a version 2 map descriptor.  The new values have
been patched into this, and the original values are lost. 
.B
^*User action:\* None.
.B
.I -4;NEWRAD,  using sphere of equal area to spheroid
.B
^*Explanation:\* A spheroid has been specified, while working on a
projection that is only defined for a sphere.  Under these
circumstances, ITRANS uses a sphere which has the same area as the
specified spheroid. 
.B
^*User action:\* If this is not the desired action, on completion of the
run of ITRANS, delete the transformed IFF file and re-run ITRANS,
specifying a sphere rather than a spheroid. 
.B
.I -4;OUTFILEDEF,  using default output file _<'file-spec'_>
.B
^*Explanation:\* When the /LOG qualifier has been given, this message is
output if no output IFF file has been specified. 
.B
^*User action:\* None.
.B
.I -4;REENTER,  reenter input values
.B
^*Explanation:\* <CTRL/Z> has been entered in response to a prompt or an
internal arithmetic error has occurred while initialising a projection
or empirical transformation. 
.B
^*User action:\* Reenter the last few values.
.LEFT MARGIN -4

.PAGE
^*--------------------------------------------------------------------------------\*
.HL 2 ^*MESSAGES (warning)\*
.B
These messages are output when an error has occurred that can be
corrected immediately by the user. 
.B
.LEFT MARGIN +4
.I -4;BADCPTS,  badly conditioned control points
.B
^*Explanation:\* ITRANS has not been able to solve the empirical
transformation using the supplied control points, perhaps because they
have been given in the wrong order, or they do not adequately control
the relationship between the input and output coordinate spaces.
.B
^*User action:\* Reenter the target values for the control points.
.B
.I -4;BADHEMI,  two angles are both latitude or both longitude
.B
^*Explanation:\* User has input two longitude or two latitude values,
rather than one of each, when transforming individual geographical
points. 
.B
^*User action:\* Enter two angles with correct hemisphere suffix.
.B
.I -4;BADPRJCDW,  invalid projection code
.B
^*Explanation:\* User has entered a number that does not correspond to a
valid projection code. 
.B
^*User action:\* Enter '?' to obtain list of valid codes, and enter one
of them. 
.B
.I -4;BADMODSTOPT,  'integer' is invalid modified-stereographic option code
.B
^*Explanation:\* User has entered a number that does not correspond to a
valid projection code. 
.B
^*User action:\* Enter '?' to obtain list of valid codes, and enter one
of them. 
.B
.I -4;BADPRJSPH,  inconsistent projection and spheroid
.B
^*Explanation:\* Certain projections are only defined for specific
spheroids. The projection code that has been specified is not valid with
the specified spheroid as it is one of these. 
.B
^*User action:\* Select another projection code or, if the spheroid is
wrong, exit from ITRANS and convert the data onto the correct spheroid
and  use ITRANS with the /DESCRIPTOR qualifier to alter the spheroid
code in the map descriptor. 
.B
.I -4;BADPRJTYP,  cannot mix spherical and spheroidal projections
.B
^*Explanation:\* Some of the projections that ITRANS operates on are
only defined for a sphere, not a spheroid.  It is not sensible to
convert from one type to another. 
.BR
If a sphere has been specified, (either spheroid code 19 or 20 or a user
specified spheroid (code 101) defined as a sphere), this error will not
occur. 
.B
^*User action:\* Select another (spheroidal) projection, or exit from
ITRANS, convert the data from the spheroid onto a sphere and then use
ITRANS with the /DESCRIPTOR qualifier to update the map descriptor. 
.B
.I -4;BADSPHCDW,  invalid spheroid code
.B
^*Explanation:\* User has entered a number that does not correspond to a
valid spheroid code. 
.B
^*User action:\* Enter '?' to obtain list of valid codes, and enter one
of them. 
.B
.I -4;BADSPSZON,  invalid SPS zone
.B
^*Explanation:\* User has entered a number that does not correspond to a
valid state plane projection system zone. 
.B
^*User action:\* Enter '?' to obtain list of valid zones, and enter one
of them. 
.B
.I -4;BADUNTCDW,  invalid unit code
.B
^*Explanation:\* User has entered a number that does not correspond to a
valid unit code. 
.B
^*User action:\* Enter '?' to obtain list of valid codes, and enter one
of them. 
.B
.I -4;BADUTMZON,  invalid UTM zone
.B
^*Explanation:\* User has entered a number that does not correspond to a
valid UTM zone. 
.B
^*User action:\* Enter '?' to obtain data about UTM zones and enter
another value, or if the UTM zone is unknown enter zone 0.  This will
make ITRANS prompt further for the latitude and longitude of a point in
the area of interest. 
.B
.I -4;DSERR,  arithmetic error while shifting datum
.B
^*Explanation:\* An arithmetic error has occurred while converting from
one geodetic datum to another. This is probably caused by the operator
entering the datum shift parameters incorrectly.
.B
^*User action:\* Check the values of the datum shift parameters, and
rerun the program 
.B
.I -4;EOF,  program terminated prematurely by '_^Z'
.B
^*Explanation:\* The user has entered <CTRL/Z> to the first prompt when 
defining a projection.
.B
^*User action:\* None.
.B
.I -4;ERRCPTS,  residuals in X and Y of 'X real' and 'Y real'
.B
^*Explanation:\* When there are more than the minimum number of control
points required for a particular transformation, the ambiguity is
resolved by the use of a least squares solution. This leaves residuals
at the control points, and when the maximum residual in X or the maximum
residual in Y is greater that 1/1000th of the range in X and Y then this
message is output. 
.B
^*User action:\* The user can either accept these residuals and
continue, or choose to reenter the target values of the control points. 
.B
.I -4;ILLEGANGVAL,  impossible value for component of angle
.B
^*Explanation:\* An angle has been input with a value of one of its
components that is impossible (e_.g_. minutes greater than 60) 
.B
^*User action:\* Reenter the angle with correct value.
.B
.I -4;ILLEGDECPT,  only last component in angle may have decimal point
.B
^*Explanation:\* An angle has been input where more than one of its
components has a decimal point. 
.B
^*User action:\* Reenter the angle with correct value.
.B
.I -4;ILLEGINPUT,  illegal input units for datum shift
.B
^*Explanation:\* When using the /DATUM__SHIFT qualifier, the  input 
units must be angular, not linear. This message should not occur with
files that have been correctly processed.
.B
^*User action:\* Use ITRANS/DESCRIPTOR to correct the unit code
.B
.I -4;ILLEGLAT,  illegal latitude value
.B
^*Explanation:\* A latitude value has been entered with an absolute
value greater than 90 degrees. 
.B
^*User action:\* Reenter the angle with correct value.
.B
.I -4;ILLEGLONG,  illegal longitude value
.B
^*Explanation:\* A longitude value has been entered with an absolute
value greater than 180 degrees. 
.B
^*User action:\* Reenter the angle with correct value.
.B
.I -4;ILLEGOUTPUT,  illegal output units for datum shift
.B
^*Explanation:\* When using the /DATUM__SHIFT qualifier, the  output 
units must be angular, not linear. This message should not occur.
.B
^*User action:\* Report problem to Laser-Scan
.B
.I -4;IMPOSUNT,  no FEET with user-specified spheroid
.B
^*Explanation:\* Projection units for all the spheroids defined within
ITRANS are metres, and there is a known relationship between them and
feet. When using a user specified spheroid, the projection units are
unknown, and it is not possible to use FEET 
.B
^*User action:\* Use an internally defined spheroid, or specify a user
defined spheroid in feet, and specify unit code 2 (projection units). 
.B
.I -4;INVALANGUNT,  no 'ddd mm ss.ss' format  when transforming files
.B
^*Explanation:\* Unit code 200 is not possible when dealing with files.
This message should not occur.
.B
^*User action:\* Exit from ITRANS and patch the map descriptor entry,
using ITRANS with the /DESCRIPTOR qualifier, to contain a valid unit
code. 
.B
.I -4;INVALSCL,  scale of 1:'scale' is invalid when dealing with 'units'
.B
^*Explanation:\* Using table or sheet units requires a sensible scale.
.B
^*User action:\* Enter valid value for scale factor (a value greater
than 0) 
.B
.I -4;INVALTABUNT,  no table units when transforming points
.B
^*Explanation:\* It is not possible to specify unit codes 101 - 105 when 
dealing with points.
.B
^*User action:\* Enter '?' to obtain list of valid codes, and enter one
of them. 
.B
.I -4;INVALUNT,  inconsistent unit on projection
.B
^*Explanation:\* Angular units can only be used when dealing with
geographical coordinates, and scalar units can only be used when dealing
with a projection. 
.B
^*User action:\* Enter '?' to obtain list of valid codes, and enter one
of them. 
.B
.I -4;INVALUSEUNT,  no user units without an empirical transformation
.B
^*Explanation:\* The size of user units (unit code 105) are defined by
the values of the control points that are entered when doing an
empirical transformation.  This is the only way that data can be
converted into user units.
.B
^*User action:\* Complete any required projection calculations by
selecting an acceptable target unit code and then re-run ITRANS with the
/TWO, /THREE, /FOUR or /PROJECTIVE qualifier. 
.B
.I -4;NOTGEOGS,  need geographical coordinates for datum shift
.B
^*Explanation:\* The user has entered a projection code other than 100
while using the /DATUM__SHIFT qualifier. Geodetic datum shifts can only
be carried out on Geographical coordinates (Latitude and Longitude)
.B
^*User action:\* Enter 100 to the "Projection :" prompt
.B
.I -4;NOHEMI,  no hemisphere allowed with angle in this context
.B
^*Explanation:\* The angle required at this point must be in the form
sDDD MM SS.SS, without a hemisphere suffix
.B
^*User action:\* Reenter the angle in the correct format
.B
.I -4;NOTUNSET,  cannot specify UNSET code
.B
^*Explanation:\* It is not possible to do projection calculations if the 
projection code or unit code is set to 0.
.B
^*User action:\* Enter '?' to obtain list of valid codes, and enter one
of them. 
.B
.I -4;NOV2MD,  map descriptor is not version 2
.B
^*Explanation:\* The input IFF file does not have a version 2 map descriptor.
.B
^*User action:\* The user will be asked to specify a map descriptor  for the 
current IFF file.
.B
.I -4;SGNANDHEMI,  sign and hemisphere present in angle
.B
^*Explanation:\* An angle has been input that is both  preceded by a sign and 
succeeded by a hemisphere code.
.B
^*User action:\* Reenter a valid angle.
.B
.I -4;UNSETMD,  map descriptor is unset
.B
^*Explanation:\* The map descriptor in the input IFF file is unset.
.B
^*User action:\* The user will be asked to specify a map descriptor  for the 
current IFF file.
.B
.I -4;UNEXPEOL,  unexpected end of line
.B
^*Explanation:\* An incomplete line has been input.
.B
This error should not occur.
.B
^*User action:\* Reenter complete line
.B
.I -4;UNEXPCH,  unexpected character 'character' found
.B
^*Explanation:\* An invalid character 'character' has occurred in an input line.
.B
^*User action:\* Reenter a valid value.
.B
.I -4;UNSETPRJ,  projection code unset
.B
^*Explanation:\* The projection code field in the map descriptor in the
input IFF file is unset. 
.B
^*User action:\* The user will be asked to specify a map descriptor  for
the current IFF file (using the fields that are set as defaults). 
.B
.I -4;UNSETUNT,  unit code unset
.B
^*Explanation:\* The unit code field in the map descriptor in the input
IFF file is unset. 
.B
^*User action:\* The user will be asked to specify a map descriptor  for the 
current IFF file (using the fields that are set as defaults).
.B
.I -4;WGCTPERR,  projection error
.B
^*Explanation:\* While using ITRANS with the /POINT qualifier, an error
has occurred while carrying out the projection transformation.  It will
be followed by an explanation of the error. 
.B
^*User action:\* Reenter a valid point to transform.
.B
.I -4;WRNGHEM,  wrong hemisphere
.B
^*Explanation:\* A latitude value has been input when a longitude was
expected or vice versa. 
.B
^*User action:\* Reenter the angle with the correct hemisphere letter.
.B
.I -4;2MANYLINES Too many lines of points in control file, truncating.
.B
^*Explanation:\* The number of lines of control points in the file specified
with the /CONTROL qualifier exceeds the maximum allowed, (see above), all 
lines after the maximum allowed will be ignored and ITRANS will continue
as normal
.B
^*User action:\* The user may decided to edit the file and rerun ITRANS.

.LEFT MARGIN -4

.PAGE
^*--------------------------------------------------------------------------------\*
.HL 2 ^*MESSAGES (fatal)\*
.B
After these messages have been output, ITRANS will be aborted.  This may
leave an invalid IFF file that should be deleted. 
.LEFT MARGIN +4
.B
.I -4;BADPRJCDS,  invalid projection code
.B
^*Explanation:\* ITRANS tries to output an invalid projection code.
This should not happen.
.B
^*User action:\* Correct the projection code field of the map descriptor
with ITRANS and the /DESCRIPTOR qualifier, and try again. 
.B
.I -4;BADSPHCDS,  invalid spheroid code
.B
^*Explanation:\* ITRANS tries to output an invalid spheroid code.
This should not happen.
.B
^*User action:\* Correct the spheroid code field of the map descriptor
with ITRANS and the /DESCRIPTOR qualifier, and try again. 
.B
.I -4;BADUNTCDS,  invalid unit code
.B
^*Explanation:\* ITRANS tries to output an invalid unit code.
This should not happen.
.B
^*User action:\* Correct the unit code field of the map descriptor with 
ITRANS and the /DESCRIPTOR qualifier, and try again.
.B
.I -4;CTRLFILERR,  error reading the control file
.B
^*Explanation:\* An error has been encountered trying to read from the 
control file.
.B
.BR
This message will be followed by a description of the error.
.B
^*User action:\* Check the control file, according to the given message.
.B
.I -4;ERROPNCTRL,  error opening the control file 'filename'
.B
^*Explanation:\* An error has been encountered trying to open the 
control file.
.B
.BR
This message will be followed by a description of the error.
.B
^*User action:\* Check that the control file exists, according to the
given message, and rerun ITRANS with a valid control point file.
.B
.I -4;FGCTPERR,  projection error
.B
^*Explanation:\* ITRANS has tried to carry out an illegal projection 
transformation on a point in the IFF file. This may be a control point.
.BR
This message will be followed by a description of the error.
.B
^*User action:\* Correct the value of the point in the IFF file and
re-run ITRANS, or do not carry out this projection calculation. 
.B
.I -4;INCONSPH, inconsistent input and output spheroids.  See documentation 
.B
^*Explanation:\* ITRANS cannot be used to change spheroids.  
.B
^*User action:\* use ITRANS/DATUM__SHIFT to change geodetic datum
\* 
.B
.I -4;NOCP,  no control point entry found in IFF file
.B
^*Explanation:\* The input IFF file does not have a valid format and the 
control point entry is missing.
.B
^*User action:\* Correct the error in the data and re-run ITRANS
.B
.I -4;NOTGEOGS,  need geographical coordinates for datum shift
.B
^*Explanation:\* The input IFF file does not have projection code 100,
but the /DATUM__SHIFT qualifier has been given.
.B
^*User action:\* Convert the IFF file to geographicals using ITRANS in 
its default mode, then change the datum
.B
.I -4;NOMD,  no map descriptor
.B
^*Explanation:\* The input IFF file does not have a valid format and the 
map descriptor entry is missing.
.B
^*User action:\* Correct the error in the data and re-run ITRANS
.B
.I -4;NOTPLANE,  no empirical transformation on geographical coordinates
.B
^*Explanation:\* It is not possible to do a empirical transformation on 
geographical coordinates.
.B
^*User action:\* Transform the geographical data onto a projection
before trying to do an empirical transformation 
.B
.I -4;PREMEOL,  premature end of line, four control points expected
.B
^*Explanation:\* A line in the control file appears to contain one,
two or three control points, where four was expected.
.B
^*User action:\* Amend the control file so that each line containing 
control points has four points - originalX  originalY  targetX  targetY
.B
.I -4; UNEXPAT, "@" not allowed in input file
.B
^*Explanation:\* A file being used to input coordinates to ITRANS in
/POINT contains a "@" sign. It is not possible to have nested files
of coordinates.
.B
^*User action:\* Correct the input file, and rerun ITRANS
.B
.I -4;WRNGCPTS,  LHS and RHS of control point entry not equal
.B
^*Explanation:\* The control point entry in the input IFF file has
different left hand side and right hand side values. 
.B
^*User action:\* Correct the CP entry in the IFF file, or run ITRANS
with the /TWO, /THREE, /FOUR or /PROJECTIVE qualifier to do an empirical
transformation on the data using the existing right hand side control
point values. 
.B
.I -4;2FEWPTS, not enough sets of control points for specified transformation
.B
^*Explanation:\* The number of lines of control points in the control file 
is less than the minimum required, (see above).
.B
^*User action:\* Add more lines of control points to the control file until
the minimum required has been reached.
.B
.LEFT MARGIN -4
.PAGE
.NOFILL
^*--------------------------------------------------------------------------------\*
.HL 2 ^*MESSAGES (other)\*
.FILL
.P 0
In addition to the above messages which are generated by ITRANS itself,
other messages may be produced by the command line interpreter (CLI) and
by Laser-Scan libraries. In particular, messages may be generated by the
IFF library. These are introduced by '%IFF' and are documented in the
IFF library users' guide. In most cases IFF errors will be due to a
corrupt input file, and this should be the first area of investigation.
If the cause of the error cannot be traced by the user and Laser-Scan
are consulted, then the input file should be preserved to facilitate
diagnosis. 

.FLAGS BOLD
