.TP 10
.TITLE DFADVAL - IFF/DFAD file validation utility
.PAGE
^*--------------------------------------------------------------------------------\*
^*MODULE####DFADVAL\*
.INDEX DFADVAL
.BLANK
^*--------------------------------------------------------------------------------\*
.LM +10
.I-10;^*REPLACES\*##Existing DFADVAL.  The new module validates DFAD attribute
data held in an AC 7 entry against a DLMS Rule file, and has an option to
produce a LITES2 guidance file.
.LM -10
.BLANK
^*--------------------------------------------------------------------------------\*
.HEADER LEVEL 1 ^*FUNCTION\*
.INDEX DFADVAL>FUNCTION
.LM +10
.P 0;DFADVAL validates an IFF file containing DFAD data. It performs
validation on feature geometry, DFAD accuracy region attributes (AC8 entries
in layer zero features), and DFAD point, line and area attribute records (AC7
entries in features in layers other than zero).  The module also validates
entries in the MCE map header. 
.P 0;Optionally, a LITES2 command file may be produced, which may be used with
the Laser-Scan cartographic editor LITES2, to aid the correction of any
features that fail validation. 
.LM -10
.BLANK
^*--------------------------------------------------------------------------------\*
.HEADER LEVEL 1 ^*FORMAT\*
.INDEX DFADVAL> FORMAT

.NO FILL
.LM +10
.P 0;$ DFADVAL file-spec
.BL
^*Command qualifiers                      Defaults\*

.INDEX DFADVAL> COMMAND QUALIFIERS
/[NO]AC                                 /AC
.INDEX DFADVAL> COMMAND QUALIFIERS> /AC
/[NO]BOUNDS                             /BOUNDS
.INDEX DFADVAL> COMMAND QUALIFIERS> /BOUNDS
/[NO]DUPLICATES                         /DUPLICATES
.INDEX DFADVAL> COMMAND QUALIFIERS> /DUPLICATES
/[NO]INFORMATION                        /INFORMATION
.INDEX DFADVAL> COMMAND QUALIFIERS> /INFORMATION
/LAYER=(integer[,...])              No default
.INDEX DFADVAL> COMMAND QUALIFIERS> /LAYER
/LIST=file-spec                         Default output to SYS$OUTPUT
.INDEX DFADVAL> COMMAND QUALIFIERS> /LIST
/LITES2=[file-spec]                     No LITES2 file produced
.INDEX DFADVAL> COMMAND QUALIFIERS> /LITES2
/[NO]LOOPCHECK                          /LOOPCHECK
.INDEX DFADVAL> COMMAND QUALIFIERS> /LOOPCHECK
/[NO]PRINTER                            /NOPRINTER
.INDEX DFADVAL> COMMAND QUALIFIERS> /PRINTER
/RULES=file-spec                        No rules file used
.INDEX DFADVAL> COMMAND QUALIFIERS> /RULES
/TOLERANCE=real                         /TOLERANCE=1.0
.INDEX DFADVAL> COMMAND QUALIFIERS> /TOLERANCE
/TYPE='AC' or 'FS'                      /TYPE='FS'
.INDEX DFADVAL> COMMAND QUALIFIERS> /TYPE
/[NO]WARNINGS                           /WARNINGS
.INDEX DFADVAL> COMMAND QUALIFIERS> /WARNINGS

.LM -10
.BLANK
.TP 10
^*--------------------------------------------------------------------------------\*
.HEADER LEVEL 1 ^*PROMPTS
.INDEX DFADVAL> PROMPTS
.NO FILL
.LM +10
Input IFF-file:         input IFF file to be validated

.LM -10
.BLANK
.TP 6
^*--------------------------------------------------------------------------------\*
.HEADER LEVEL 1 ^*PARAMETERS\*
.INDEX DFADVAL> PARAMETERS
.FILL
.LM +10

.P -10;Input IFF-file
.P -2;-#specifies the IFF file to be validated. Any part of 
the file specification which is not supplied will be taken from the default 
'LSL$IF:IFF.IFF;0'. 

.LM -10
.BLANK
.SUBTITLE COMMAND QUALIFIERS
.TP 10
^*--------------------------------------------------------------------------------\*
.HEADER LEVEL 1 ^*COMMAND QUALIFIERS\*
.INDEX DFADVAL> COMMAND QUALIFIERS
.LM +10

.TP10
.P -10;/AC (default)
.I -10;/NOAC
.INDEX DFADVAL> COMMAND QUALIFIERS> /AC
.P -2;-#If this qualifier is present, the utility will validate the attribute
data held in the AC text field of an accuracy region, or DFAD point, line or
area feature.  The text field is checked to ensure that all attributes are
present and valid for the type of feature, and that the values conform to the
DLMS format Specification.  If the /RULES qualifier is present, the attribute
values are also validated against a DLMS Rules File.
.P -2;##If /NOAC is specified, the attributes held in the AC entry are not
validated.

.BL
.P -10;/BOUNDS (default)
.I -10;/NOBOUNDS
.INDEX DFADVAL> COMMAND QUALIFIERS> /BOUNDS
.P -2;-#if this qualifier is present, the utility checks that all coordinates
in the IFF file are within the manuscript area as defined by the latitude and
longitude corner values in the map header. Any features found with coordinates
outside the manuscript limits are reported. If /NOBOUNDS is specified, no
checks are carried out on the range of the coordinates in the file. 

.BL
.P -10;/DUPLICATES(default)
.I -10;/NODUPLICATES
.INDEX DFADVAL> COMMAND QUALIFIERS> /DUPLICATES
.P -2;-#If this qualifier is present, the utility checks the coordinate
strings for duplicate points.  Any duplicate points are reported in the
validation report. Note that the coordinate values are converted to the
nearest integer value before comparison. 
.p -2;##If /NODUPLICATES is specified, no checks are carried out for duplicate
coordinate points. 

.BL
.P -10;/INFORMATION (default)
.I -10;/NOINFORMATION
.INDEX DFADVAL> COMMAND QUALIFIERS> /INFORMATION
.P -2;-#specifies that informational messages be produced. Such 
messages do not signal invalid entries in the IFF file, but give 
information about what it contains.
.BL
.P -10;/LAYER=(integer[,...])              No default
.INDEX DFADVAL> COMMAND QUALIFIERS> /LAYER
.P -2;-#allows the user to specify a list of specific layers to be
reported, eg /LAYER=(1,2). If this qualifier is not specified then all 
layers are reported.
.BL
.P -10;/LIST=file-spec (default /LIST=SYS$OUTPUT:)
.INDEX DFADVAL> COMMAND QUALIFIERS> /LIST
.P -2;-#allows the user to specify a list file to which the validation report 
will be directed. If this qualifier is not supplied, output is directed to
SYS$OUTPUT.
.BL
.P -10;/LITES2=[file-spec]
.INDEX DFADVAL> COMMAND QUALIFIERS> /LITES2
.P -2;-#If /LITES2 is specified, a LITES2 guidance file will be created, with
the supplied file specification. The file-spec is parsed against the
default template LSL$LITES2CMD:DFADVAL.LCM. This file may be used to aid the 
subsequent editing of features that have failed validation, using the LITES2 
cartographic editor. 
.BL
.P -10;/LOOPCHECK (default)
.I -10;/NOLOOPCHECK
.INDEX DFADVAL> COMMAND QUALIFIERS> /LOOPCHECK
.P -2;-#if /LOOPCHECK is specified, then DFADVAL will perform a check for
crossing or touching line segments in linear or areal features. Any crossing
or touching segments will be reported to the user by means of validation
failure warning messages. 
.BL
.P -10;/PRINTER
.I -10;/NOPRINTER (default)
.INDEX DFADVAL> COMMAND QUALIFIERS> /PRINTER
.P -2;-#if this qualifier is specified, then the validation report will 
be written to a temporary file. The contents of this file will be spooled to 
SYS$PRINT and the disk file will be deleted on program completion. This 
qualifier cannot be present with the /LIST qualifier.
.BL
.P -10;/RULES=file-spec (optional)
.INDEX DFADVAL> COMMAND QUALIFIERS> /RULES
.P -2;-#this qualifier allows the user to specify a DLMS Rule file, against
which any DFAD attribute data, held in the text field of an AC7 entry will be
checked. If a feature fails validation, warning messages are generated
indicating the fields which may have caused the failure of the feature record.
The attribute data is in addition, validated against the DLMS format
specification. 
.BR;If this qualifier is not used, then the DFAD attribute data are only
checked against the DLMS format specification. 
.BL
.P -10;/TOLERANCE=real (default /TOLERANCE=1.0)
.INDEX DFADVAL> COMMAND QUALIFIERS> /TOLERANCE
.P -2;-#this qualifier allows the user to specify the tolerance within which 
two line segments, in linear or areal features, must lie of each other to be 
detected as touching or crossing. 
.BL
.P -10;/TYPE='AC'
.I -10;/TYPE='FS' (default)
.INDEX DFADVAL> COMMAND QUALIFIERS> /TYPE
.P -2;-#/The TYPE qualifier is used to specify whether the feature type
(point, line or area) should be derived from a feature's AC or FS entry. If
/TYPE=FS is specified (or the qualifier is absent) the feature type is derived
from the feature code (first word of the FS entry), with feature codes of 102,
101 and 100 indicating a DFAD area, line and point feature respectively. 
.I -2;##If /TYPE=AC is specified, then the feature type is derived from the 
the 'typ' field of the text part of the AC7 entry.
.BL
.P -10;/WARNINGS (default)
.I -10;/NOWARNINGS
.INDEX DFADVAL> COMMAND QUALIFIERS> /WARNINGS
.P -2;-#if present, this qualifier will cause DFADVAL to output validation
failure warnings. These are similar to the validation errors which are always
output, except that they relate to less serious failures. For example, DFAD
attribute records which do not obey the DLMS specification are reported by
means of error messages, whereas a failure to obey an entry in the DLMS rules
file is reported with a warning message. 
.LM -10
.BLANK
.TP 10
^*--------------------------------------------------------------------------------\*
.HEADER LEVEL 1 ^*RESTRICTIONS\*
.INDEX DFADVAL> RESTRICTIONS
.LM +10
.list "o"
.le; /PRINTER and /LIST is not allowed
.LE; /RULES and /NOAC is not allowed
.LE; /TYPE=AC and /TYPE=FS is not allowed
.end list
.LM -10
.BLANK
.SUBTITLE DESCRIPTION
.TP 10
^*--------------------------------------------------------------------------------\*
.HEADER LEVEL 1 ^*DESCRIPTION\*
.INDEX DFADVAL> DESCRIPTION
.LM +10
.P0;DFADVAL is a utility to validate the attribute content and geometry of an
IFF file containing DLMS DFAD data. It will generally be run before the data
is written to a DFAD format tape. A validation report is produced at the
terminal or sent to a user specified list file. A LITES2 command file may also
be generated. 

.P0; By default, the coordinates of DFAD features are checked to ensure that
they are within the manuscript bounds.  This check may be suppressed using the
/NOBOUNDS qualifier. 

.P0;By default, line and area features are checked for crossing or touching
line segments.  This check may be suppressed using the /NOLOOPCHECK qualifier.
Point, line and area features are checked that are not defined with too few or
too many data points. 

.P0;By default, the attributes attached to DFAD features are validated. Checks
are performed to ensure that all attributes are present and valid for the type
of feature, and the values conform to the DLMS format specification. If the
/RULES qualifier is present, the attribute values are also validated against a
DLMS Rules File. Checks on the attributes may be suppressed using the
/NOAC qualifier. 

.P0;Validation against entries in the Rule file takes into account not only
the individual attribute values, but the combination of those values
within a feature record.  Hence, if more than one field in a record is
reported as possibly being invalid, it may not be necessary to change all the
fields mentioned to make the record obey the validation rules. Since
the validation rules provide only a guide to the expected normal range
of field values, certain exceptional features may lie outside these rules and
yet still be correct. For this reason, rule validation failures are reported
only as warnings, whereas failures to adhere to the DLMS specification are
reported as errors. 

.P 0;The accuracy region records (held in AC8 entries in layer zero 
features) relating to absolute and relative accuracies are similarly 
validated against the DLMS specification. The utility assumes that accuracy 
region features have a feature code of 301.

.P0;If the /LITES2 qualifier is present on the command line, a LITES2 guidance
will be produced. This file may be used with the LITES2 cartographic editor to
aid the correction of any features that have failed validation. When obeyed by
LITES2, messages describing the problem are produced, and the cursor is
positioned on the feature. A 'RESPOND' in the command file allows the user to
perform any required editing of the feature. Issuing the 'CONTINUE' command
will cause LITES2 to read the next series of commands from the guidance file.
For most validation failures, the cursor will be positioned over the first
point in a feature. For failures relating to a particular point or line
segment within a feature (e.g. crossing line segments), the cursor will be
positioned on or near the offending point or segment. 
.Bl 3
.TP 5
^*The following should be noted when using DFADVAL:\*
.list "o"
.le;The map corners in the Map Header (MH) entry are used to define the 
manuscript bounds for all range checks.
.le;All coordinates are rounded to the nearest integer before
checking for errors.
.le;"Point n" refers to the nth point in the point string (ST) entry or 
entries in a feature.
.le;"Segment n" refers to the line segment from point n to point n+1.
.le;In the line segment crossover check, every segment is checked for touching
or crossing EVERY other, except its immediate neighbours. If the tolerance for
this check is zero, only segments which actually cross each other will be
detected, but if it is greater than zero, then all segments which come to
within that tolerance of each other will be detected as 'touching'. 
.le;The check for crossing or touching segments will always take
at least twice as long as a check for crossing segments alone.
.els
.LM -10
.BLANK
.TP 10
^*--------------------------------------------------------------------------------\*
.SUBTITLE VALIDATION REPORT
.HEADER LEVEL 1 ^*VALIDATION REPORT\*
.INDEX DFADVAL> VALIDATION REPORT
.LM +10
.P0;The validation report will contain informational messages if the
/INFORMATION qualifier is specified, and warning messages if the /WARNINGS
qualifier is specified. Error messages will always be written to the
validation report. 
.P0; Warning messages are prefixed with the letter 'W', and error messages
with the letter 'E'. Any messages relating to specific features will contain: 
.P10;FSN fsn:
.P0;where 'fsn' is the Feature Serial Number of the feature.
.LM -10
.BLANK
.TP 10
^*--------------------------------------------------------------------------------\*
.SUBTITLE VALIDATION REPORT
.HEADER LEVEL 2 ^*INFORMATIONAL MESSAGES\*
.INDEX DFADVAL> VALIDATION REPORT> INFORMATIONAL MESSAGES
.LM +10
.P0;Informational messages give details on the following topics:
.ls " "
.le;^*HEADER INFORMATION\*
.le;The manuscript's unique reference
.le;The SW corner latitude and longitude coordinates
.le;The SE corner latitude and longitude coordinates
.le;The NE corner latitude and longitude coordinates
.le;The NW corner latitude and longitude coordinates
.le;The latitude and longitude extents of the manuscript
.le;The manuscript latitude and longitude origin
.tp14
.bl
.le;^*LAYER INFORMATION\*
.le;The layer number
.le;The FSN of the first feature in the layer
.le;The feature type of the first feature
.le;FSN Sequence breaks (missing features)
.le;The FSN of the last feature in the layer
.le;The total number of features in the layer
.tp8
.bl
.le;^*SUMMARY INFORMATION\*
.le;The total number of features in the IFF file
.le;The total number of errors reported
.le;The total number of warnings reported
.els
.LM -10
.BLANK
.TP 10
^*--------------------------------------------------------------------------------\*
.SUBTITLE VALIDATION REPORT
.HEADER LEVEL 2 ^*WARNING MESSAGES\*
.INDEX DFADVAL> VALIDATION REPORT> WARNING MESSAGES
.LM +10
.P0;Warning messages are produced if the following are found:
.ls " "
.le;^*FEATURE RECORDS\*
.le;Segments in an areal feature that touch 
.le;Segments in a linear feature that touch or cross
.le;A feature type change within a layer
.le;A feature type greater than the last feature type
.le;A point feature with more than 1 point
.le;Repeated points are found in a feature
.le;An attribute field that does not obey general rules in the Rule file.
.le;An attribute field that does not obey specific validation rules in the
Rule file. 
.els
.LM -10
.BLANK
.TP 10
^*--------------------------------------------------------------------------------\*
.SUBTITLE VALIDATION REPORT
.HEADER LEVEL 2 ^*ERROR MESSAGES\*
.INDEX DFADVAL> VALIDATION REPORT> ERROR MESSAGES
.LM +10
.P0;Error messages are produced if:
.nj
.ls " "
.tp14
.le;^*MAP HEADER ERRORS\*
.le;No MCE map header is found
.le;The manuscript corners are not square
.le;The manuscript corners are not correctly ordered
.le;The Latitude extent is incompatible with the latitude corner values
.le;The Longitude  extent is incompatible with the longitude corner values
.le;The Latitude of the map origin is not 1 minute south of the SW map corner
.le;The Longitude of the map origin is not 1 minute west of the SW map corner
.le;The SW corner latitude is not between +/-90 degrees
.le;The SE corner latitude is not between +/-90 degrees
.le;The NW corner latitude is not between +/-90 degrees
.le;The NE corner latitude is not between +/-90 degrees
.le;The SW corner longitude is not between +/-180 degrees
.le;The SE corner longitude is not between +/-180 degrees
.le;The NW corner longitude is not between +/-180 degrees
.le;The NE corner longitude is not between +/-180 degrees
.le;The Map origin latitude is not between +/-90 degrees
.le;The Map origin longitude is not between +/-180 degrees
.le;The Map extent latitude is not between +/-90 degrees
.le;The Map extent longitude is not between +/-180 degrees
.le;The Absolute height accuracy is not in the range 0-9999m
.le;The Relative height accuracy is not in the range 0-9999m
.le;The Predominant height accuracy is not in the range 0-9999m
.bl
.tp6
.le;^*ACCURACY REGION ERRORS\*
.le;An accuracy region does not contain an AC 8 entry
.le;A coordinate of the accuracy region is outside the manuscript range
.le;An accuracy region attribute field is found more than once
.le;An accuracy region attribute field is not in the range 0-9999m
.le;More than one value is found for an accuracy region attribute field
.le;An accuracy region has less than 3 points
.le;An accuracy region has more than 14 points
.le;The points of an accuracy region are defined in the wrong order
.le;There are too many accuracy regions. There should be at most 9.
.le;There are too few accuracy regions. There should be at least 2 or none at 
all.
.tp24
.bl
.le;^*FEATURE 1 ERRORS\*
.le;There is no feature 1 in the IFF file
.le;The feature does not have an AC 7 entry
.le;Feature 1 is not of type 2 (ie. not an area feature)
.le;Feature 1 does not have a smc value of 6 or 10
.le;Feature 1 is not defined with 5 points
.le;Point 1 is not equal to the manuscript SW corner
.le;Point 2 is not equal to the manuscript SE corner
.le;Point 3 is not equal to the manuscript NE corner
.le;Point 4 is not equal to the manuscript NW corner
.le;Point 5 is not equal to the manuscript SW corner
.tp14
.bl
.le;^*OTHER FEATURE ERRORS\*
.le;A feature has no AC 7 entry
.le;A feature has no ST entry
.le;Coordinate point is outside the range of the manuscript
.le;The feature has an illegal feature serial number (greater than 16383)
.le;The feature's FSN is out of sequence ( FSN <= last FSN)
.le;An attribute field does not obey the DLMS specification
.le;An attribute field is not present
.le;An attribute field is present more than once
.le;An attribute field is present, but should not be for this type of
feature 
.tp14
.bl
.le;^*AREAL FEATURE ERRORS (TYPE = 2)\*
.le;The feature is not closed
.le;The feature is defined clockwise
.le;The feature is defined with more than 8191 points
.le;The feature is defined with less than 4 non-repeated points
.le;Segments in the feature cross
.tp6
.bl
.le;^*LINEAR FEATURE ERRORS (TYPE = 1)\*
.le;The feature is defined with more than 8191 points
.le;The feature is defined with less than 2 non-repeated points
.tp4
.bl
.le;^*POINT FEATURE ERRORS (TYPE = 0)\*
.le;The feature is define with more than 2047 points
.els
.LM -10
.BLANK
.SUBTITLE EXAMPLES
.PAGE
.HEADER LEVEL 1 ^*EXAMPLES\*
.INDEX DFADVAL> EXAMPLES
.BLANK
.TP10
.BL
.NO FILL
$ ^*DFADVAL DFADTEST<CR>\*

DFADVAL Validation Report
------------------------------------------------------------
 
IFF file - LSL$DATA_ROOT:[LSL.IFF]DFAD1.IFF;54
Created on  22-FEB-1988 13:54:56.99
Updated on  23-FEB-1988 10:47:35.64 (2)
 
Include general information?   : YES
Include warnings?              : YES
Perform coord bounds check?    : YES
Perform areal crossover check? : YES, with tolerance   1.000
Perform duplicate point check? : YES
Perform AC validation?         : YES
Feature types taken from FS entries
 
------------------------------------------------------------
 
Unique reference - 1              
 
SW corner   Lat -33 33 33.3   Long -044 44 44.4
SE corner   Lat -33 33 33.3   Long  180 00 00.0
NE corner   Lat  90 00 00.0   Long  180 00 00.0
NW corner   Lat  90 00 00.0   Long -044 44 44.4
Map extents Lat  23 33 33.3   Long  224 44 44.4
Map origin  Lat -12 34 56.7   Long -123 45 59.8
E    Lat of map origin not 1 min south of SW map corner
E    Long of map origin not 1 min west of SW map corner
E    Map extent latitude not between +/-90 deg
E    Map extent longitude not between +/-180 deg
 
LAYER 0
E    FSN      1: Accuracy region field RELV not in range 0-9999m.
E    FSN      1: Accuracy region field RELH not in range 0-9999m.
E    FSN      1: X coord of point 1 out of range
E    FSN      1: X coord of point 2 out of range
E    FSN      1: X coord of point 3 out of range
E    FSN      2: X coord of point 1 out of range
E    FSN      2: X coord of point 2 out of range
E    FSN      2: X coord of point 3 out of range
     2 features in layer
 
LAYER 1
E    Feature 1 must have smc 6 or 10
E    Feature 1 not type 2
     First feature 1 is type 0
E    FSN      1: X coord of point 1 out of range
E    FSN      2: X coord of point 1 out of range
     FSN 3 missing
E    FSN      4: X coord of point 1 out of range
     FSN 5 - 9 missing
E    FSN     10: X coord of point 1 out of range
E    FSN     11: X coord of point 1 out of range
E    FSN     12: X coord of point 1 out of range
     FSN 13 - 19 missing
E    FSN     20: X coord of point 1 out of range
     Last feature 20
     7 features in layer
 
Total number of features        9
Total number of errors         21
Total number of warnings        0
 
 ELAPSED:    0 00:00:03.06  CPU: 0:00:01.34  BUFIO: 64  DIRIO: 13  FAULTS: 159 
$
.FILL
.LM +10
.P0;This example shows the operation of DFADVAL without any qualifiers
specified on the command line, so that the default settings 
are used. Output is to SYS$OUTPUT, with errors, warnings and informational
messages being produced. No rules file is used. The loopcheck is performed
with tolerance 1.0. Bounds checking is performed.
.LM -10

.BL4
.TP10
.BL
.NO FILL
$ ^*DFADVAL DFADTEST/NOBOUNDS/NODUPLICATES/NOLOOPCHECK<CR>\*

DFADVAL Validation Report
------------------------------------------------------------
 
IFF file - LSL$DATA_ROOT:[LSL.IFF]DFAD1.IFF;54
Created on  22-FEB-1988 13:54:56.99
Updated on  23-FEB-1988 10:47:35.64 (2)
 
Include general information?   : YES
Include warnings?              : YES
Perform coord bounds check?    : NO
Perform areal crossover check? : NO
Perform duplicate point check? : NO
Perform AC validation?         : YES
Feature types taken from FS entries
 
------------------------------------------------------------
 
Unique reference - 1              
 
SW corner   Lat -33 33 33.3   Long -044 44 44.4
SE corner   Lat -33 33 33.3   Long  180 00 00.0
NE corner   Lat  90 00 00.0   Long  180 00 00.0
NW corner   Lat  90 00 00.0   Long -044 44 44.4
Map extents Lat  23 33 33.3   Long  224 44 44.4
Map origin  Lat -12 34 56.7   Long -123 45 59.8
E    Lat of map origin not 1 min south of SW map corner
E    Long of map origin not 1 min west of SW map corner
E    Map extent latitude not between +/-90 deg
E    Map extent longitude not between +/-180 deg
 
LAYER 0
E    FSN      1: Accuracy region field RELV not in range 0-9999m.
E    FSN      1: Accuracy region field RELH not in range 0-9999m.
     2 features in layer
 
LAYER 1
E    Feature 1 must have smc 6 or 10
E    Feature 1 not type 2
     First feature 1 is type 0
     FSN 3 missing
     FSN 5 - 9 missing
     FSN 13 - 19 missing
     Last feature 20
     7 features in layer
 
Total number of features        9
Total number of errors          8
Total number of warnings        0
 
 ELAPSED:    0 00:00:03.06  CPU: 0:00:01.34  BUFIO: 64  DIRIO: 13  FAULTS: 159 
$
.FILL
.LM +10
.P0;In this example all coordinate checks are disabled by means of the
/NOBOUNDS /NODUPLICATES and /NOLOOPCHECK qualifiers.  Checks are performed
only on the AC fields of the DFAD features.
.LM -10
.BL4
.TP10
.NO FILL
$ ^*DFADVAL/RULES=[DFAD.VALTAB]VALTAB DFAD1<CR>\*

DFADVAL Validation Report
------------------------------------------------------------
 
IFF file - DUA0:[MCE.IFF]DFAD1.IFF;1
Created on   9-NOV-1983 15:23:13.00
Updated on  20-JAN-1988 14:11:25.34 (7)
 
Include general information?   : YES
Include warnings?              : YES
Perform coord bounds check?    : YES
Perform areal crossover check? : YES, with tolerance   1.000
Perform duplicate point check? : YES
Perform AC validation          : YES
Feature types taken from FS entries
 
------------------------------------------------------------
 
Unique reference - UK SQUARE 79   
 
SW corner   Lat  58 00 00.0   Long -005 00 00.0
SE corner   Lat  58 00 00.0   Long -004 00 00.0
NE corner   Lat  59 00 00.0   Long -004 00 00.0
NW corner   Lat  59 00 00.0   Long -005 00 00.0
Map extents Lat  01 00 00.0   Long  001 00 00.0
Map origin  Lat  57 59 00.0   Long -005 01 00.0
 
LAYER 0
     2 features in layer
 
LAYER 1
     First feature 1 is type 2
W    FSN    115: Segments     43 and     45 touch nr  29824 ,  10289
W    FSN    158: Segments   1751 and   1753 touch nr  21325 ,  18000
W    FSN    226: Segments      4 and      6 touch nr  19003 ,  15224
W    FSN    233: Segments      1 and     22 touch nr  19651 ,  13883
W    FSN    245: Segments     49 and     51 touch nr  16142 ,  12403
W    FSN    381: Segments    546 and    548 touch nr  22123 ,   1504
W    FSN    406: Segments    195 and    197 touch nr  16287 ,   8751
W    FSN    467: Segments      1 and     39 touch nr  20235 ,    600
     Last feature 512
     512 features in layer
 
LAYER 2
     FSN 513 - 612 missing
     First feature 613 is type 1
W    FSN    624: Segments     16 and     18 touch nr  29649 ,  20269
W    FSN    626: Segments     20 and     23 touch nr  32891 ,  20802
W    FSN    626: Segments     21 and     23 touch nr  32892 ,  20802
W    FSN    626: Segments     52 and     54 cross at  32413 ,  21063
W    FSN    631: Segments     37 and     39 touch nr  35942 ,  22220
W    FSN    731: Field hgt may not obey validation table specific rules.
W    FSN    733: Field hgt may not obey validation table specific rules.
     Last feature 736
     124 features in layer
 
LAYER 3
     FSN 737 - 2736 missing
     First feature 2737 is type 0
W    FSN   2844: Point feature with > 1 (33) points
W    FSN   3050: Point feature with > 1 (104) points
     Last feature 3050
     314 features in layer
 
Total number of features      952
Total number of errors          0
Total number of warnings       17
 
 ELAPSED:  0 00:13:28.81  CPU: 0:05:18.62  BUFIO: 71  DIRIO: 11047  FAULTS: 767 
$
.FILL
.LM +10
.P0;In this example, the DFAD attribute data is is validated against the rules
file in the specified DLMS Rule file. Two warnings are produced indicating
that features 731 and 733 have failed validation. 
.LM -10
.BL4
.TP 10
.NO FILL
$ ^*DFADVAL/TOLERANCE=0 DFAD1<CR>\*

DFADVAL Validation Report
------------------------------------------------------------
 
IFF file - DUA0:[MCE.IFF]DFAD1.IFF;1
Created on   9-NOV-1983 15:23:13.00
Updated on  20-JAN-1988 14:11:25.34 (7)
 
Include general information?   : YES
Include warnings?              : YES
Perform coord bounds check?    : YES
Perform areal crossover check? : YES, with tolerance   0.000
Perform duplicate point check? : YES
Perform AC validation?         : YES
Feature types taken from FS entries
 
------------------------------------------------------------
 
Unique reference - UK SQUARE 79   
 
SW corner   Lat  58 00 00.0   Long -005 00 00.0
SE corner   Lat  58 00 00.0   Long -004 00 00.0
NE corner   Lat  59 00 00.0   Long -004 00 00.0
NW corner   Lat  59 00 00.0   Long -005 00 00.0
Map extents Lat  01 00 00.0   Long  001 00 00.0
Map origin  Lat  57 59 00.0   Long -005 01 00.0
 
LAYER 0
     2 features in layer
 
LAYER 1
     First feature 1 is type 2
     Last feature 512
     512 features in layer
 
LAYER 2
     FSN 513 - 612 missing
     First feature 613 is type 1
W    FSN    626: Segments     52 and     54 cross at  32413 ,  21063
     Last feature 736
     124 features in layer
 
LAYER 3
     FSN 737 - 2736 missing
     First feature 2737 is type 0
W    FSN   2844: Point feature with > 1 (33) points
W    FSN   3050: Point feature with > 1 (104) points
     Last feature 3050
     314 features in layer
 
Total number of features      952
Total number of errors          0
Total number of warnings       15
 
 ELAPSED:    0 00:07:03.79  CPU: 0:02:21.71  BUFIO: 64  DIRIO: 512  FAULTS: 348 
$
.FILL
.LM +10
.P0;This example shows the use of the /TOLERANCE qualifier to change the
default tolerance within which tests for touching and crossing line segments
are performed. Here, a zero tolerance is specified, so only line segments in
areal or linear features which actually cross, as opposed to touch, are
reported. 
.LM -10
.BL 4
.TP 10
.NO FILL
$ ^*DFADVAL/TYPE=AC/NOLOOPCHECK/NODUPLICATES DFAD1<CR>\*

DFADVAL Validation Report
------------------------------------------------------------
 
IFF file - DUA0:[MCE.IFF]DFAD1.IFF;1
Created on   9-NOV-1983 15:23:13.00
Updated on  20-JAN-1988 14:11:25.34 (7)
 
Include general information?   : YES
Include warnings?              : YES
Perform coord bounds check?    : YES
Perform areal crossover check? : NO
Perform duplicate point check? : NO
Perform AC validation?         : YES
Feature types taken from AC entries
 
------------------------------------------------------------
 
Unique reference - UK SQUARE 79   
 
SW corner   Lat  58 00 00.0   Long -005 00 00.0
SE corner   Lat  58 00 00.0   Long -004 00 00.0
NE corner   Lat  59 00 00.0   Long -004 00 00.0
NW corner   Lat  59 00 00.0   Long -005 00 00.0
Map extents Lat  01 00 00.0   Long  001 00 00.0
Map origin  Lat  57 59 00.0   Long -005 01 00.0
 
LAYER 0
     2 features in layer
 
LAYER 1
     First feature 1 is type 2
     Last feature 512
     512 features in layer
 
LAYER 2
     FSN 513 - 612 missing
     First feature 613 is type 1
     Last feature 736
     124 features in layer
 
LAYER 3
     FSN 737 - 2736 missing
     First feature 2737 is type 0
W    FSN   2844: Point feature with > 1 (33) points
W    FSN   3050: Point feature with > 1 (104) points
     Last feature 3050
     314 features in layer
 
Total number of features      952
Total number of errors          0
Total number of warnings        2
 
 ELAPSED:    0 00:02:52.20  CPU: 0:00:54.96  BUFIO: 51  DIRIO: 512  FAULTS: 255 
$
.FILL
.LM +10
.P 0;In the above case, the /NOLOOPCHECK qualifier specifies that no checking 
for touching or crossing line segments is performed, while the /NODUPLICATES
qualifier disables checking for duplicate points.
.LM -10
.BL 4
.TP 10
.NO FILL
$ ^*DFADVAL/NOLOOPCHECK/NODUPLICATES/NOAC/NOWARNINGS/NOINFORMATION DFAD1<CR>\*

DFADVAL Validation Report
------------------------------------------------------------
 
IFF file - DUA0:[MCE.IFF]DFAD1.IFF;1
Created on   9-NOV-1983 15:23:13.00
Updated on  20-JAN-1988 14:11:25.34 (7)
 
Include general information?   : NO
Include warnings?              : NO
Perform coord bounds check?    : YES
Perform areal crossover check? : NO
Perform duplicate point check? : NO
Perform AC validation?         : NO
Feature types taken from FS entries
 
------------------------------------------------------------
 
 
 
 ELAPSED:    0 00:02:03.56  CPU: 0:00:54.23  BUFIO: 20  DIRIO: 516  FAULTS: 168 
$
.FILL
.LM +10
.P 0;In this example, in addition to the /NOLOOPCHECK and /NODUPLICATES
qualifier, the /NOWARNINGS and /NOINFORMATION qualifiers specify that no
warning or informational messages should be generated. The /NOAC qualifier
specifies the attributes held in a feature's AC entry should not be validated.
Since no validation errors are found in the input file, only the validation
report header is produced. 
.LM -10
.BL 4
.TP 10
.NO FILL
$ ^*DFADVAL/RULES=[DFAD.VALTAB]VALTAB/LITES2=DFAD1.LCM DFAD1<CR>\*

DFADVAL Validation Report
------------------------------------------------------------
 
IFF file - DUA0:[MCE.IFF]DFAD1.IFF;1
Created on   9-NOV-1983 15:23:13.00
Updated on  20-JAN-1988 14:11:25.34 (7)
 
Include general information?   : YES
Include warnings?              : YES
Perform coord bounds check?    : YES
Perform areal crossover check? : YES, with tolerance   1.000
Perform duplicate point check? : YES
Perform AC validation?         : YES
Feature types taken from FS entries
 
------------------------------------------------------------
 
Unique reference - UK SQUARE 79   
 
SW corner   Lat  58 00 00.0   Long -005 00 00.0
SE corner   Lat  58 00 00.0   Long -004 00 00.0
NE corner   Lat  59 00 00.0   Long -004 00 00.0
NW corner   Lat  59 00 00.0   Long -005 00 00.0
Map extents Lat  01 00 00.0   Long  001 00 00.0
Map origin  Lat  57 59 00.0   Long -005 01 00.0
 
LAYER 0
     2 features in layer
 
LAYER 1
     First feature 1 is type 2
W    FSN    115: Segments     43 and     45 touch nr  29824 ,  10289
W    FSN    158: Segments   1751 and   1753 touch nr  21325 ,  18000
W    FSN    226: Segments      4 and      6 touch nr  19003 ,  15224
     Last feature 512
     512 features in layer
 
LAYER 2
     FSN 513 - 612 missing
     First feature 613 is type 1
W    FSN    624: Segments     16 and     18 touch nr  29649 ,  20269
W    FSN    626: Segments     20 and     23 touch nr  32891 ,  20802
W    FSN    731: Field hgt may not obey validation table specific rules.
W    FSN    733: Field hgt may not obey validation table specific rules.
     Last feature 736
     124 features in layer
 
LAYER 3
     FSN 737 - 2736 missing
     First feature 2737 is type 0
W    FSN   2844: Point feature with > 1 (33) points
W    FSN   3050: Point feature with > 1 (104) points
     Last feature 3050
     314 features in layer
 
Total number of features      952
Total number of errors          0
Total number of warnings        9
 
 ELAPSED:  0 00:17:13.43  CPU: 0:05:24.59  BUFIO: 72  DIRIO: 11051  FAULTS: 717 
.FILL
.BL
.LM +10
.P 0; This example illustrates the production of a LITES2 command file which 
can be used to guide the user to invalid features using the LITES2 
cartographic editor. The validation is performed using a rules file specified 
with /RULES. The validation report output is directed to SYS$OUTPUT, and the 
LITES2 commands are written to a file specified with the /LITES2 qualifier. 
The contents of the LITES2 guidance file 'DFAD1.LCM' are as follows:
.LM -10
.BL2
.NO FILL
%POSITION   600.000   600.000
%POSITION 36600.000 36600.000
%ABANDON
%MESSAGE 
%MESSAGE                L I T E S 2   C O M M A N D   F I L E
%MESSAGE 
%MESSAGE                              created by
%MESSAGE 
%MESSAGE =========================== D F A D V A L ============================ 
%MESSAGE 
%MESSAGE DFADVAL invoked by JON using terminal RTA2: at 26-FEB-1988 11:07:45.36 
%MESSAGE  
%MESSAGE Command line:
%MESSAGE  
%MESSAGE DFADVAL/RULES=[DFAD.VALTAB]VALTAB/LITES2=DFAD1.LCM DFAD1 
%MESSAGE 
%MESSAGE ======================================================================
%MESSAGE 
%ABANDON
%ABANDON
%MESSAGE "Feature 115: segments 43 and 45 touch nr 29824 , 10289"
%POSITION      29824.000      10289.000
%TEST $CURSINWIN
%ELSE %ZOOM 1
%RESPOND
%ABANDON
%MESSAGE "Feature 158: segments 1751 and 1753 touch nr 21325 , 18000"
%POSITION      21325.000      18000.000
%TEST $CURSINWIN
%ELSE %ZOOM 1
%RESPOND
%ABANDON
%MESSAGE "Feature 226: segments 4 and 6 touch nr 19003 , 15224"
%POSITION      19003.000      15224.000
%TEST $CURSINWIN
%ELSE %ZOOM 1
%RESPOND
%ABANDON
%MESSAGE "Feature 624: segments 16 and 18 touch nr 29649 , 20269"
%POSITION      29649.000      20269.000
%TEST $CURSINWIN
%ELSE %ZOOM 1
%RESPOND
%ABANDON
%MESSAGE "Feature 626: segments 20 and 23 touch nr 32891 , 20802"
%POSITION      32891.000      20802.000
%TEST $CURSINWIN
%ELSE %ZOOM 1
%RESPOND
%ABANDON
%MESSAGE "Feature 731: field hgt may not obey  validation table specific rules."
%POSITION      23180.000       1113.000
%TEST $CURSINWIN
%ELSE %ZOOM 1
%RESPOND
%ABANDON
%MESSAGE "Feature 733: field hgt may not obey  validation table specific rules."
%POSITION      22786.000       1080.000
%TEST $CURSINWIN
%ELSE %ZOOM 1
%RESPOND
%ABANDON
%MESSAGE "Feature 2844: point feature with > 1 (33) points"
%POSITION      36487.000       2833.000
%TEST $CURSINWIN
%ELSE %ZOOM 1
%RESPOND
%ABANDON
%MESSAGE "Feature 3050: point feature with > 1 (104) points"
%POSITION      10452.000       7286.000
%TEST $CURSINWIN
%ELSE %ZOOM 1
%RESPOND
%ABANDON
$
.FILL
.BL4
.TP 10
.NO FILL
$ ^*DFADVAL/RULES=[DFAD.VALTAB]VALTAB/LIST=DFAD1.LIS DFAD1<CR>\*

%DFADVAL-I-LISTOUT, List output is being directed to DFAD1.LIS
 ELAPSED:   0 00:19:19.69  CPU: 0:05:24.09  BUFIO: 8  DIRIO: 11049  FAULTS: 802 
.BL
$ ^*DFADVAL/RULES=[DFAD.VALTAB]VALTAB/PRINTER DFAD1<CR>\*

%DFADVAL-I-PRINTOUT, List output is being directed to the printer
 ELAPSED:   0 00:14:16.52  CPU: 0:05:21.48  BUFIO: 9  DIRIO: 11053  FAULTS: 750 
$
.FILL
.LM +10
.P0;The two examples above illustrate the use of the /LIST and /PRINTER 
qualifiers to direct the validation report to a file and the printer 
respectively.
.LM -10
.SUBTITLE MESSAGES
.PAGE
.LM 0
^*--------------------------------------------------------------------------------\*
.INDEX DFADVAL> MESSAGES
.HEADER LEVEL 1 ^*MESSAGES (informational)\*
.J
.BL
These messages give information only, and require no immediate action by the
user. They are often used to supply explanatory information in support of a
warning or error message. 
.BL
.LM +4

.SKIP
.INDENT -4;LISTOUT  List output is being directed to list file ^*file-spec\*
.LM +13
.P -13;^*Explanation:\*#List output is being directed to the file specified 
with the /LIST qualifier.

.P -13;^*User action:\*#None.
.LM -13

.SKIP
.INDENT -4;PRINTOUT  List output is being directed to the printer\*
.LM +13
.P -13;^*Explanation:\*#List output is being directed to the printer as 
specified by the /PRINTER qualifier. 

.P -13;^*User action:\*#None.
.LM -13
.NO JUSTIFY
.SUBTITLE MESSAGES
.PAGE
.LM 0
^*--------------------------------------------------------------------------------\*
.INDEX DFADVAL> MESSAGES
.HEADER LEVEL 1 ^*MESSAGES (error)\*
.BLANK
These messages indicate an error in processing which has caused the program to
terminate. If an error occurs, it is unlikely that any output file produced 
will be correctly processed.
.LEFT MARGIN +4

.SKIP
.INDENT -4;TOOMNYINTS, Too many intersections found
.LM +13
.P -13;^*Explanation:\*#While performing the LOOPCHECK operation more than 50
intersection points were found. The remaining intersection points are
ignored.
.P -13;^*User action:\*#The fact that so many intersection points have been
found for this feature, indicates a serious problem in the feature geometry.
Correct the feature using the mechanisms you would normally use to correct
other errors in feature geometry.\ 
.lm -13
.bl

.INDENT -4;UNOPNRULE, Cannot open specified rule file
.LM +13
.P -13;^*Explanation:\*#The rule file specified in the command line cannot be 
found or opened
.P -13;^*User action:\*#Check that the rule file specification was correct and 
that the file exists. Then respecify the command line with a corrected file 
specification.
.LM -13
.BL

.INDENT -4;UNCLORULE, Cannot close the rule file used
.LM +13
.P -13;^*Explanation:\*#The rule file during the validation cannot be closed 
correctly.
.P -13;^*User action:\*#Check that the rule file is not damaged. If the 
problem persists, contact Laser-Scan.
.LM -13
.SUBTITLE MESSAGES
.PAGE
.LM 0
^*--------------------------------------------------------------------------------\*
.HEADER LEVEL 1 ^*MESSAGES (other)\*
.INDEX DFADVAL> MESSAGES
.FILL
.BL
In addition to the above messages which are generated by DFADVAL itself, other
messages may be produced by the command line interpreter (CLI) and by Laser-Scan
libraries. In particular, messages may be generated by the IFF library. These
are introduced by '%IFF' and are documented in the IFF library users' guide.
In most cases IFF errors will be due to a corrupt input file, and this should
be the first area of investigation. If the cause of the error cannot be traced
by the user and Laser-Scan are consulted, then the input file should be
preserved to facilitate diagnosis.

