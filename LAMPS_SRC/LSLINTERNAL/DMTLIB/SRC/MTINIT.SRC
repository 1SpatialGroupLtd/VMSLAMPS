	INTEGER*4 FUNCTION MTINIT(FILE_SPEC,NOREW,TYPE)
C
***	IDENT	24AP89
***	MODULE	MTINIT

C	Copyright : Laser-Scan Laboratories Ltd., Cambridge, England
C	Created   : Andrew C Morris			24-Apr-89

C Description
C	Opens file-structured volume for reading, and returns
C	LSL__NORMAL for success, LSL__NOSUCHDEV for failure
C
	IMPLICIT NONE
C
	INCLUDE '($SSDEF)'
C
C Parameters in
	CHARACTER*(*)	FILE_SPEC	! file spec
	LOGICAL*4	NOREW		! dummy
	INTEGER*4	TYPE		! dummy
C
	INCLUDE 'LSL$CMNLSL:LSLLIBMSG.PAR'
	INCLUDE 'LSL$CMNLSL:MTIVCM.CMN'
	INCLUDE 'LSL$CMNDMT:DMTCMN.CMN'
C
C Workspace
	LOGICAL*4	UNIT_USED	! unit already in use?
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
	MTINIT = LSL__NORMAL		! assume success
C
	MTINBL = 0			! zero block count
C
	DO 5 DMT_INPUT_LUN = 1,999		! find first free unit number
	   INQUIRE(UNIT=DMT_INPUT_LUN,OPENED=UNIT_USED)
	   IF (.NOT.UNIT_USED) GOTO 7
5	CONTINUE
	GOTO 10				! fail
C
7	OPEN(UNIT=DMT_INPUT_LUN,NAME=FILE_SPEC,TYPE='OLD',READONLY,
     &	   FORM='UNFORMATTED',ERR=10)
	GOTO 20
C
10	MTINIT = LSL__NOSUCHDEV		! file not found
	CALL ERRSNS(,MTIERR,,,)		! MTIERR = STS system error
C
20	RETURN
	END
