	INTEGER*4 FUNCTION MTONIT(FILE_SPEC,DN1600,NOREW,TYPE)
C
***	IDENT	28AP89
***	MODULE	MTONIT

C	Copyright : Laser-Scan Laboratories Ltd., Cambridge, England
C	Created   : Andrew C Morris			24-Apr-89

C Description
C	Opens file-structured volume for reading, and returns
C	LSL__NORMAL for success, LSL__NOSUCHDEV for failure
C
	IMPLICIT NONE
C
	INCLUDE '($SSDEF)'
C
C Parameters in
	CHARACTER*(*)	FILE_SPEC	! file spec
	LOGICAL*4	DN1600		! dummy
	LOGICAL*4	NOREW		! dummy
	INTEGER*4	TYPE		! dummy
C
	INCLUDE 'LSL$CMNLSL:LSLLIBMSG.PAR'
	INCLUDE 'LSL$CMNLSL:MTOVCM.CMN'
	INCLUDE 'LSL$CMNDMT:DMTCMN.CMN'
C
C Workspace
	LOGICAL*4	UNIT_USED	! unit already in use?
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
	MTONIT = LSL__NORMAL		! assume success
C
	MTONBL = 0			! zero block count
C
	DO 5 DMT_OUTPUT_LUN = 1,999		! find first free unit number
	   INQUIRE(UNIT=DMT_OUTPUT_LUN,OPENED=UNIT_USED)
	   IF (.NOT.UNIT_USED) GOTO 7
5	CONTINUE
	GOTO 10				! fail
C
7	OPEN(UNIT=DMT_OUTPUT_LUN,NAME=FILE_SPEC,TYPE='NEW',
     &	   FORM='UNFORMATTED',ERR=10)
	GOTO 20
C
10	MTONIT = LSL__NOSUCHDEV		! file not found
	CALL ERRSNS(,MTOERR,,,)		! MTOERR = STS system error
C
20	RETURN
	END
