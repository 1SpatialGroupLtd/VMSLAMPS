	SUBROUTINE CHEKRA
C
***	IDENT	30MY90
***	MODULE	CHEKRA
C
C	Copyright LaserScan Laboratories Ltd., Cambridge, England
C
C author TJ Ibbs, 27.jan.82 & sqq
C
C copied from old OSCLIP and amended for IMP IWINDOW 
C by R J Hulme, 22-May-1986
C
	IMPLICIT NONE
C
C to check/update the RAnge values
C
C common blocks, etc
C
***	PARAMETER/LSL$CMNIWIN:MAX/	! maximum things
***	COMMON/LSL$CMNIWIN:CLIP/	! contains boundaries
***	COMMON/LSL$CMNIWIN:COPY/	! transfer for output
C
C
	IF (.NOT.HADRAN) GOTO 10
C
C here, had RAnge started, so check against what's in it
C
	IF (RANGE(MINIM,X).GT.OUTBUF(X,CURRNT))
     &				RANGE(MINIM,X) = OUTBUF(X,CURRNT)
	IF (RANGE(MAXIM,X).LT.OUTBUF(X,CURRNT))
     &				RANGE(MAXIM,X) = OUTBUF(X,CURRNT)
	IF (RANGE(MINIM,Y).GT.OUTBUF(Y,CURRNT))
     &				RANGE(MINIM,Y) = OUTBUF(Y,CURRNT)
	IF (RANGE(MAXIM,Y).LT.OUTBUF(Y,CURRNT))
     &				RANGE(MAXIM,Y) = OUTBUF(Y,CURRNT)
C
	GOTO 20
C
C here, must find output RAnge and set up initial RAnge values
C
10	RANGE_OUT(MINIM,X) = MAX(CLIPLO(W),RANGE(MINIM,X))
	RANGE_OUT(MAXIM,X) = MIN(CLIPHI(E),RANGE(MAXIM,X))
	RANGE_OUT(MINIM,Y) = MAX(CLIPLO(S),RANGE(MINIM,Y))
	RANGE_OUT(MAXIM,Y) = MIN(CLIPHI(N),RANGE(MAXIM,Y))
C
	RANGE(MINIM,X) = OUTBUF(X,CURRNT)
	RANGE(MAXIM,X) = OUTBUF(X,CURRNT)
	RANGE(MINIM,Y) = OUTBUF(Y,CURRNT)
	RANGE(MAXIM,Y) = OUTBUF(Y,CURRNT)
C
	HADRAN = .TRUE.
C
20	CONTINUE
C
	RETURN
	END
C
