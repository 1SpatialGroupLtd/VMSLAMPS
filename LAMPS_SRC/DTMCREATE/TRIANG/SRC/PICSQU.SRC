	SUBROUTINE PICSQU(NOD,DIST,IX,IY,IA,IB,MINC,JA,JB,KINC)
C
***	MODULE	PICSQU
***	IDENT	20JL84
C
C Copyright Laser-Scan Laboratories Limited, Cambridge, England.
C
CMOD	Tidied					 DM	20-Jul-1984
CMOD	INDB and NAYB now in MAC		 DM	29-May-1984
C	Standardised				TJH 	25-May-1984
C
C......Pick up points in boxes (if any) in the range from box
C......rows IA to IB, with increment of MINC, and columns JA to JB
C......with increment of KINC. This routine enables a hollow
C......square expansion search to be made from a given position
C......by using two calls to it. The first picks up the top and
C......bottom rows of boxes falling in the hollow square, and the
C......second gets the remaining sides of the square of boxes.
C
	INCLUDE 'LSL$CMNTRIANG:DATQ.CMN'
C
C ......................................................................
C
C......Set up rows, and check for being outside limits of box area
C......DO loop not used because IA may well be 0 or negative.
	IC=IA-MINC
10	IC=IC+MINC
	IF (IC.LT.1) GOTO 10
	IF (IC.GT.IB.OR.IC.GT.NBI) GOTO 50
	K=(IC-1)*NBJ
C......Do the same for columns. Do loop not used for the same reasons
	JC=JA-KINC
20	JC=JC+KINC
	IF (JC.LT.1) GOTO 20
	IF (JC.GT.JB.OR.JC.GT.NBJ) GOTO 10
	MARK=0
C......Get box contents for box L
	L=K+JC
	L=IN(L)
C......Are there any points in box IC,JC?
	IF (L.EQ.0) GOTO 20
C......Check for this point having been deleted from the data set
30	IF (IABS(MAC(5,L)).EQ.1) GOTO 40
C......Check them for being closer than the present closest (node NOD
C......is DIST away from IX,IY)
	CALL EUCLID(IX,IY,MAC(1,L),MAC(2,L),D,0)
	IF (D.GT.DIST) GOTO 40
	DIST=D
	NOD=L
C......Get next point in box
40	L=IABS(MAC(4,L))
	IF (L.EQ.NPMAX) GOTO 20
	GOTO 30
50	RETURN
	END

