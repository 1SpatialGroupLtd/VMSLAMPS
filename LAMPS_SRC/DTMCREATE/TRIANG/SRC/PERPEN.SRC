	SUBROUTINE PERPEN(IXA,IYA,IXB,IYB,IX,IY,D)
C
***	MODULE PERPEN
**	IDENT 25MY84
C
C	Copyright Laser-Scan Laboratories Ltd., Cambridge, England
C
C	Standardised			TJH 	 25-May-1984
C
C......Calculate the perpendicular distance from a point IX,IY
C......to a line defined by the ends IXA,IYA and IXB,IYB. The
C......distance on output is stored in D.
C
C......Get length of line
	CALL EUCLID(IXA,IYA,IXB,IYB,D,1)
C......Get sin and cos of angle of line
	SA=(IYA-IYB)/D
	CA=(IXA-IXB)/D
C......Get tangent (slope) of angle using sin and cos, allowing for
C......a vertical line
	KARK=0
	IF(ABS(CA).GT.1.E-5)GOTO 10
	KARK=1
	TA=SIGN(1.,-SA)
	GOTO 20
C......Non-vertical tangent calculation
10	TA=SA/CA
C......Calculate perpendicular distance
20	D=(IX-IXA)*TA
	IF(KARK.EQ.1)GOTO 30
	D=(IY-IYA)-D
	D=D*CA
30	D=ABS(D)
	RETURN
	END

