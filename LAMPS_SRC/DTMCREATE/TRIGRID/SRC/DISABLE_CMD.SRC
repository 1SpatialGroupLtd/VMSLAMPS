	LOGICAL FUNCTION DISABLE_CMD()
C
***	MODULE	DISABLE_CMD
***	IDENT	24AU99
C
C	Copyright (C), Laser-Scan Laboratories Ltd., Cambridge, England
C
CMOD	Only issue limit cancellation warning if individual
C	triangle limits set				TJH 02-Mar-1989
C	Created						TJH 23-Jul-1987
C
C Function to set command switches 'off' eg DISABLE GRAPHICS. This
C replaces the grotty CMDLIB + or - mechanism and must be used in
C conjunction with function ENABLE for turning switches on again. 
C
C Function returns .TRUE. if all is well, .FALSE. if an error
C
	IMPLICIT NONE
C
C W/s
	INTEGER		CMD     ! decoded command number
C
C Parameters:
	INCLUDE		'LSL$DTMCREATESYS:MESPAR.PAR'
C
C Common blocks:
	INCLUDE 'LSL$DTMCREATESYS:CONTRL.CMN'
	INCLUDE 'LSL$CMNLSL:CMDCOM.CMN'
	INCLUDE 'LSL$CMNLSL:EXPC.CMN'
	INCLUDE 'LSL$DTMCREATESYS:GRAFCS.CMN'
	INCLUDE 'LSL$DTMCREATESYS:GRAFDEV.CMN'
	INCLUDE 'LSL$CMNLSL:STATUS.CMN'
	INCLUDE 'LSL$DTMCREATESYS:FINDIT.CMN'
	INCLUDE 'LSL$CMNLSL:TXTC.CMN'
C
C Functions:
	INTEGER		RDCOMM		! get command
	LOGICAL		IS_ALPHA_AXP
C
C Command table:
	EXTERNAL	DISABLE_CMD_TABLE
	INTEGER		DISABLE_CMD_TABLE
C
C ......................................................................
C
	DISABLE_CMD=.TRUE.			! assume success
C
	CMD=RDCOMM(DISABLE_CMD_TABLE)		! get command
	GOTO (
     &		5,	! error/nothing
     &		10,	! auto_limits
     &		15,	! debug
     &		20,	! diagnostics
     &		40,	! graphics
     &		50,	! nint
     &		60,	! orthogonal
     &		70,	! pme
     &		100,	! smooth
     &		105	! trace
     &			), CMD+1
C
C
C command number out of range
	CALL WRITEF('Command not yet implemented')
	DISABLE_CMD=.FALSE.
	GOTO 110
C
C ......................................................................
C ENABLE ...
C
5	CALL WRITEF
	CALL WRITEF('%S Specifying command DISABLE',ERROR)
	CALL WRITEF
	CALL WRITEF('Available DISABLE command qualifiers are:')
	CALL WRITEF
	CALL WRITEF(
     &	   'AUTO_LIMITS    DEBUG       DIAGNOSTICS   GRAPHICS     NINT')
	CALL WRITEF
	CALL WRITEF(
     &	   'ORTHOGONAL     PME         SMOOTH        TRACE')
	CALL WRITEF
	DISABLE_CMD=.FALSE.
	GOTO 110
C
C ......................................................................
C DISABLE AUTO_LIMITS
C
10	ATOLIM=.FALSE.
	GOTO 110
C
C ......................................................................
C DISABLE DEBUG
C
15	DEBUG=.FALSE.
	GOTO 110
C
C ......................................................................
C DISABLE DIAGNOSTICS
20	DIAG=.FALSE.
	GOTO 110
C
C ......................................................................
C DISABLE GRAPHICS
C
40	GRAPHICS=.FALSE.
	GOTO 110
C
C ......................................................................
C DISABLE NINT
C
50	TRUNCATE=.TRUE.
	GOTO 110
C
C ......................................................................
C DISABLE ORTHOGONAL
C
60	ORTHOG=.FALSE.
	GOTO 110
C
C ......................................................................
C DISABLE PME  - Performance monitor and evaluation
C
70	IF (.NOT.PMEING) THEN
	   CALL WRITEF('%S You were not using PME !', WARNING)
	ELSE
	   IF (.NOT.IS_ALPHA_AXP()) CALL PME_EXIT
	   PMEING=.FALSE.
	ENDIF
	GOTO 110
C
C ......................................................................
C DISABLE SMOOTH
C
100	LINEAR=1
	IF (HADTRILIM) THEN
	   CALL WRITEF(WARNING//
     &		'Linear facet interpolation selected. No smooth patch')
	   CALL WRITEF(
     &		'                related interpolation limits '//
     &		'will be applied')
	   IF (TRACE) THEN
	      CALL WRITEF(
     &  	'                and the ENABLE TRACE command '//
     &		'will be ignored')
	   ENDIF
	ELSE
	   IF (TRACE) THEN
	      CALL WRITEF(WARNING//
     &		'Linear facet interpolation selected.')
	      CALL WRITEF(
     &          '                The ENABLE TRACE command and '//
     &		'any smooth patch interpolation')
	      CALL WRITEF(
     &	        'limits will be ignored')
	   ENDIF
	ENDIF
	GOTO 110
C
C ......................................................................
C DISABLE TRACE
C
105	TRACE=.FALSE.
C
110	RETURN
	END
