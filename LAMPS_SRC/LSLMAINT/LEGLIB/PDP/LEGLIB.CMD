	.ENABLE LOWERCASE
	.ENABLE SUBSTITUTION
	.ENABLE GLOBAL
	 SET DEF [MARTIN.LEGLIB]
.;
	.IFNDF $M .ASK $M Assemble
	.IFNDF $F .ASK $F Compile
	.IFF $F .SETF $LC
	.IFNDF $LC .ASK $LC List /LEGEND/
	.IFNDF $L .ASK $L Build library
	.IFNDF $O .ASK $O One legenda option
.;
	.SETS X ".ONE"
	.IFF $O .SETS X ".LOT"
	.OPEN TR.SRC
	.DATA CODDAT = 1	; all code data of interest
	.DATA WINLEG = 0	; not using SOL''s window mechanism
	.IFT $O .DATA ONELEG = 1	; only one legenda file
	.IFF $O .DATA ONELEG = 0	; lots of legenda files
	.CLOSE
	PIP TR.SRC/PU
.;
	.IFF $M .GOTO 100
	PIP *.OBJ;*/DE
	MAC ADDLEG = TR.SRC,LEGEND,ERRORS,ADDLEG
	MAC FINCOD = TR.SRC,LEGEND,ERRORS,FINCOD
	MAC FINLEG = TR.SRC,LEGEND,ERRORS,FINLEG
	MAC FLRWVB = TR.SRC,LEGEND,ERRORS,FLRWVB
	MAC INILEG = TR.SRC,LEGEND,ERRORS,INILEG
	MAC RDLEGS = TR.SRC,LEGEND,ERRORS,RDLEGS
	PIP LEGLIB.OBM=*.OBJ
	PIP *.OBJ;*/DE
.;
.100:	.IFF $F .GOTO 200
	ADC LEGEND'X'/CO/LL:100=TR/TR,LEGEND.CMN
	.IFT $LC LST LEGEND'X'
	PIP LEGEND'X'/PU
	ADC LEGLIB.FTN = TR/TR,DRLEGS,LEGWRD,RDLEG
	F4P LEGLIB.OBF = LEGLIB
	PIP LEGLIB.FTN;*/DE
.;
.200:	.IFF $L .GOTO 900
	LBR LEGLIB'X'/CR:20=LEGLIB.OBF,LEGLIB.OBM
.;
.900:	PIP LEGLIB.*/PU
