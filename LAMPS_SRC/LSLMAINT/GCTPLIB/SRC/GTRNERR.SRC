C
C * This file is part of the LAMPS distribution, released as a software
C * preservation project to archive digital history for future historians.
C * Copyright (c) 1980-2002 Laser-Scan Ltd, 1Spatial Group Ltd
C *
C * Timestamp of this file for the 2002 release was: 1995-10-26 17:50:34.000000000 +0000
C *
C * This program is free software: you can redistribute it and/or modify
C * it under the terms of the GNU General Public License as published by
C * the Free Software Foundation, version 3.
C *
C * This program is distributed in the hope that it will be useful, but
C * WITHOUT ANY WARRANTY; without even the implied warranty of
C * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
C * General Public License for more details.
C *
C * You should have received a copy of the GNU General Public License
C * along with this program. If not, see http://www.gnu.org/licenses/.
C
	SUBROUTINE GTRNERR(IERR,SUBR,ERRMSG)
C
C ***	IDENT   26OC95
C ***	MODULE  GTRNERR
C
C	Copyright Laser-Scan Laboratories Ltd., Cambridge, England.
C
C	Written					            RWR 11-Mar-1986
C
CMOD    Converted to Fortran77 (WI/CC 1514)                 TJM 26-Oct-1995
C
C
C Description: to return the error message, and the projection
C 	       it occurred in, for an error generated by GTRN
C	       (or GTP)
C
	IMPLICIT CHARACTER*1 (A-Z)
C
C arguments (input)
C
	INTEGER		IERR		! error code returned by 
					! driver routine
C
C (output)
C
	CHARACTER*(*)	SUBR		! projection where error
					! occurred
	CHARACTER*(*)	ERRMSG		! error that occurred
C
C w/s
C
	INTEGER		NOPRJ
	PARAMETER	(NOPRJ=28)	! number of projections
					! defined in GCTP
	INTEGER		NOMSG		! number of messages
	PARAMETER	(NOMSG=27)
C
	INTEGER		NOERR		! number of error numbers
	PARAMETER	(NOERR=131)
C
	CHARACTER*30	PROJS(0:NOPRJ)	! projections
	CHARACTER*60	MSGS(NOMSG)	! error messages	
	INTEGER		ERRNO(NOERR)	! error numbers
	INTEGER		PTR(NOERR)	! pointer to error message
C
	INTEGER		I		! loop counter
C
C initialise
C
	DATA	PROJS/ 'GTRN / GTP',
     &	               'Universal Transverse Mercator',
     &	               'State Plane Coordinate System',
     &	               'Albers Conical Equal-Area',
     &	               'Lambert Conformal Conic',
     &	               'Mercator',
     &	               'Polar Stereographic',
     &	               'Polyconic',
     &	               'Equidistant Conic',
     &	               'Transverse Mercator',
     &	               'Stereographic',
     &	               'Lambert Azimuthal Equal-Area',
     &	               'Azimuthal Equidistant',
     &                 'Gnomonic',
     &	               'Orthographic',
     &	               'Gen Vert Near-Sided Perspective',
     &	               'Sinusoidal',
     &	               'Equirectangular',
     &	               'Miller Cylindrical',
     &	               'Van der Grinten',
     &	               'Oblique Mercator (Hotine)',
     &	               'Oblique Mercator (Spherical)',
     &	               'Oblique Stereograhpic-UKSL form',
     &	               'Cassini',
     &	               'Krovak',
     &	               'Bonne',
     &	               'Mollweide',
     &	               'Hammer-Aitoff',
     &	               'Winkel III'/
C
	DATA	ERRNO   / 1,2,3,4,5,6,7,8,
     &	                  11,12,13,14,		! UTM
     &	                  21,22,23,24,25,26,	! SPS
     &	                  31,32,33,34,		! Albers
     &	                  41,42,43,44,45,	! Lambert
     &	                  51,52,53,54,		! Mercator
     &	                  61,62,63,		! Polar stereographic
     &	                  71,72,73,		! Polyconic
     &	                  81,82,83,84,		! Equidistant Conic
     &	                  91,92,93,94,95,	! Transverse mercator
     &	                  101,102,103,104,	! Stereographic
     &	                  111,112,113,114,115,	! Lambert Azimuthal
     &	                  121,122,123,124,125,	! Azimuthal Equidistant
     &	                  131,132,133,134,	! Gnomonic
     &	                  141,142,143,144,145,	! Orthographic
     &	                  151,152,153,154,155,	! G V N-S P
     &	                  161,162,163,164,	! Sinusoidal
     &	                  171,172,173,174,	! Equirectangular
     &	                  181,182,183,		! Miller cylindrical
     &	                  191,192,193,194,195,	! Van der Grinten
     &	                  201,202,203,204,205,	! Oblique Mercator
     &	                     206,		! (Hotine)
     &	                  211,212,213,214,215,	! Oblique mercator
     &	                     216,		! (spherical)
     &	                  221,222,223,224,	! Oblique Stereographic
     &	                  231,232,233,234,235,	! Cassini
     &	                  241,242,243,244,245,	! Krovak
     &	                  251,252,253,254,	! Bonne
     &	                  261,262,264,265,	! Mollweide
     &	                  271,272,274,		! Hammer-Aitoff
     &	                  281,282,284,283/ 	! Winkel III
C	
	DATA	PTR     / 1,2,3,4,5,6,7,8,
     &	                  9,10,11,12,		! UTM
     &	                  9,10,11,13,12,14,	! SPS
     &	                  15,10,11,12,		! Albers
     &	                  15,10,11,16,12,	! Lambert
     &	                  10,11,17,12,		! Mercator
     &	                  10,11,12,		! Polar stereographic
     &	                  10,11,12,		! Polyconic
     &	                  15,10,11,12,		! Equidistant Conic
     &	                  10,11,18,12,19,	! Transverse mercator
     &	                  10,11,18,12,		! Stereographic
     &	                  10,11,20,12,21,	! Lambert Azimuthal
     &	                  10,11,20,12,21,	! Azimuthal Equidistant
     &	                  10,11,18,12,		! Gnomonic
     &	                  10,11,16,12,21,	! Orthographic
     &	                  10,11,16,12,21,	! G V N-S P
     &	                  10,11,12,21,		! Sinusoidal
     &	                  10,11,12,21,		! Equirectangular
     &	                  10,11,12,		! Miller cylindrical
     &	                  10,11,12,21,19,	! Van der Grinten
     &	                  22,23,10,11,18,12,	! Oblique Mercator
						! (Hotine)
     &	                  22,23,10,11,18,12,	! Oblique Mercator
						! (spherical)
     &	                  10,11,18,12,		! Oblique Stereographic
						! (UKSL specific)
     &	                  10,11,18,12,19,	! Cassini
     &	                  10,11,24,12,27,	! Krovak
     &	                  10,11,25,12,		! Bonne
     &	                  10,11,12,13,		! Mollweide
     &	                  10,11,12,		! Hammer-Aitoff
     &	                  10,11,12,14/		! Winkel III
C
	DATA   MSGS   /'Illegal input projection code',		! 1
     &	               'Illegal output projection code',	! 2
     &	               'Illegal input unit code',		! 3
     &	               'Illegal output unit code',		! 4
     &	   'Input projection code and unit code are inconsistant', ! 5
     &	   'Output projection code and unit code are inconsistant',! 6
     &	               'Illegal input zone code',		! 7
     &	               'Illegal output zone code',		! 8
     &	               'Initialisation: Illegal zone number',	! 9
     &	               'Initialisation: Missing projection parameters',
     &	               'Forward: Missing projection parameters',! 11
     &	               'Inverse: Missing projection Parameters',! 12
     &	               'Forward: Failed to converge',		! 13
     &	               'Inverse: Failed to converge ',		! 14
     &	'Initialisation: Same standard parallel, opposite hemispheres',
     &	               'Forward: Point cannot be projected',	! 16
     &	               'Forward: Cannot transform the poles',	! 17
     &	               'Forward: Point projects to infinity',	! 18
     &	               'Inverse: Latitude failed to converge',	! 19
     &	               'Forward: Point projects into a circle',	! 20
     &	               'Inverse: Input data error',		! 21
     &	         'Initialisation: Input data error (Format A)',	! 22
     &	         'Initialisation: Input data error (Format B)',	! 23
     &	'Initialistaion: Azimuthal rather than Conic Projection',! 24
     &'Initialisation: Use Sinusoidal for cylindrical form of Bonne',
     &                 'Inverse Transformation not available',	! 26
     &           'Projection not available with that spheroid'/	! 27
C
C get SUBR
C
	IF (IERR.LT.0.OR.(IERR/10).GT.NOPRJ) THEN
	      SUBR='Unknown projection'
	ELSE
	      SUBR=PROJS(IERR/10)
	ENDIF
C
C look for IERR and return corresponding MSGS
C
	IF (IERR.EQ.0) THEN
	   ERRMSG='Success'
	ELSE
	   DO 10,I=1,NOERR
	      IF (IERR.EQ.ERRNO(I)) THEN
	         ERRMSG=MSGS(PTR(I))
	         GOTO 20
	      ENDIF
   10	   CONTINUE
	   ERRMSG='Unknown error'
	ENDIF
C
   20	CONTINUE
	END
