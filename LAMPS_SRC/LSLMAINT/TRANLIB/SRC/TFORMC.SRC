	SUBROUTINE TFORMC(COORDS,GOTCC,GOTCP)
C
***	MODULE	TFORMC
***	IDENT	04SE90
C
C Copyright Laser-Scan Ltd., Cambridge, England
C
CMod	Only do CC if GOTCC, CP if GOTCP	WJJ	19-Apr-1982
CMod	Created from PGH's TFORM		WJJ	19-Apr-1982
C
C transforms a coordinate pair in COORDS by the transformation matrix
C  in CFT and then by the 4 point transform in CPTS
C
***	COMMON/LSL$CMNIFF:COEFFS/
C
	REAL COORDS(2)
	LOGICAL*1 GOTCC,GOTCP
C
	DOUBLE PRECISION X,Y
C
C first do the cubic transform
	IF (GOTCC) CALL TFORM1(COORDS)
C
	IF (.NOT.GOTCP) GOTO 99
C then the corner points
	X=COORDS(1)
	Y=COORDS(2)
C
	DO 1 I=1,2
1	   COORDS(I)=C4(1,I)+C4(2,I)*X+C4(3,I)*Y+C4(4,I)*X*Y
C
99	RETURN
C
	END
