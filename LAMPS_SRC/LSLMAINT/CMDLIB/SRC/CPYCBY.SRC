	INTEGER*4 FUNCTION COPY_CMD_BYTES(SRC, DST, CNT)
C
***	MODULE COPY_CMD_BYTES
***	IDENT 14AU84
C
	IMPLICIT NONE
C
C Copyright Laser Scan Laboratories Ltd., Cambridge, England
C Author R. Fairbairns
C
C Coded June 1983
C
C To copy bytes (with upper-casing) from a CHARACTER variable into
C	a byte array, for command-table-definition stuff
C
C Arguments (in reverse order):
	INTEGER*4	CNT		! size of:
	BYTE		DST(CNT)	! destination byte array
	CHARACTER*(*)	SRC		! source characters
C
C Function result is number of bytes actually copied (non-alphabetics
C						      are suppressed)
C
C workspace:
	BYTE		CH		! one character from the string
	INTEGER*4	CH2		! for damnfool ICHAR
	INTEGER*4	I		! loop variable
	INTEGER*4	OUTPTR		! fill pointer on array
C
C earwig-o
	OUTPTR = 0
	DO I = 1,CNT
	   CH2 = ICHAR(SRC(I:I))
	   CH = CH2
	   IF (CH.GE.'a' .AND. CH.LE.'z')
     &	      CH = CH-'a'+'A'
	   IF (CH.EQ.'_' .OR. (CH.GE.'A' .AND. CH.LE.'Z')) THEN
	      OUTPTR = OUTPTR+1
	      DST(OUTPTR) = CH
	   ENDIF
	ENDDO
C
C return what we've done	
	COPY_CMD_BYTES = OUTPTR
	RETURN
C
	END
