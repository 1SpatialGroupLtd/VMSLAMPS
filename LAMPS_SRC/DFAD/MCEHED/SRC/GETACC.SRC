	LOGICAL FUNCTION GETACC( MIN, MAX )
C
***	IDENT	27SE95
***	MODULE	GETACC
C
C	Copyright LaserScan Laboratories Ltd., Cambridge, England
C
C Author TJ Ibbs, 27 May 1983
C
CMOD	Modified to use LSLLIB.			JMB	29 Feb 1988
C
C
C Like GETINT except to ask for integer MIN to MAX OR string 'NA'
C
C We return FALSE if we get it, TRUE if they answer <return>
C
	IMPLICIT NONE
C
C
C we were passsed
C
	INTEGER*4	MIN	! minimum value allowed
	INTEGER*4	MAX	! maximum value allowed
C
C functions used
C
	LOGICAL		RDCH	! read next character
	LOGICAL		RDCHS	! read next significant char
	LOGICAL		RDLONG	! read a long integer
	INTEGER		TTRSTR	! prompt the user
C
C
C and we need common as well...
C
	INCLUDE 'LSL$CMNLSL:CMDCOM.CMN'	! to read value into
	INCLUDE 'LSL$CMNLSL:TXTC.CMN'	! for input string
	INCLUDE 'LSL$CMNLSL:EXPC.CMN'	! for building prompt string
C
C workspace
C
	INTEGER		ERR	! return from TTRLIN
	INTEGER*4	IERR	! long error
	BYTE		CHAR	! single character
C
C
C assume we get nothing
C
	GETACC = .TRUE.
C
C we prompt the user for a string of length LENGTH...
C
10	CALL EXPAND('[Integer %^L%N-%^L%N] or "NA": ', MIN, MAX )
	ERR = TTRSTR( , , EXPDSC, IERR )
C
C and did we get owt?
C
	IF ( .NOT.ERR ) THEN
	   CALL WRITEF('*** ERROR *** Reading response to prompt')
	   CALL LSL_PUTMSG( ERR )
	   CALL LSL_ADDMSG( IERR )
	   RETURN
	ELSEIF ( TXTPTR.EQ.0 ) THEN
	   RETURN			! simple <return> response
	ENDIF
C
C so we should have something - return for it to be read
C
	CALL BSLN			! start at beginning of line
	GETACC = .FALSE.		! success
	RETURN
C
	END
