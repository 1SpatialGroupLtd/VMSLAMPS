	LOGICAL FUNCTION POINT_VISIBLE()
C
***	MODULE POINT_VISIBLE
***	IDENT  26JL88
C
C	Copyright : Laser-Scan Laboratories, Cambridge, England.
C
C	Created by : Adrian Bennetton			18-July-1988
C
C This routine is designed to test whether a DTM point is within the 
C visibility distance with respect to the observer.
C
	IMPLICIT NONE
C
***	COMMON/HERE:FOG/
C
C workspace
C
	REAL 		X_DIFF		!X difference
	REAL 		Y_DIFF		!Y difference
	REAL 		Z_DIFF		!Z difference
	REAL 		DISTANCE 	!distance betwwen DTI node and observer
C
C------------------------------------------------------------------------------
C
C
C------------------------------------------------------------------------------
C Calculate the distance between the observer and the current DTI node
C
	X_DIFF = ABS_X - ABS_OBS_X
	Y_DIFF = ABS_Y - ABS_OBS_Y
	Z_DIFF = ABS_Z - ABS_OBS_Z
	DISTANCE = SQRT(X_DIFF**2 + Y_DIFF**2 + Z_DIFF**2)
	IF(DISTANCE.GT.FOG_VISIBILITY) THEN
	   POINT_VISIBLE = .FALSE.	! point in fog
	ELSE
	   POINT_VISIBLE = .TRUE.	! point not in fog
	ENDIF
C
	RETURN
	END
