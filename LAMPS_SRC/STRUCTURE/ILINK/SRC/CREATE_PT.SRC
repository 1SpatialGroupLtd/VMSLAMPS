	LOGICAL*4 FUNCTION CREATE_PT(
     &		X,Y,CCD,I_PR_FTR,PT,CC,PT_PR_FTR,MAXPTS)

***	MODULE	CREATE_PT
***	IDENT	12MR91

C	Copyright : Laser-Scan Laboratories Ltd., Cambridge, England

CMOD 2/495 Now applies range modification without
C	a division					TJH 07-Jun-1987
CMOD	Made a function					TJH 27-May-1987
C	Created   : ACM					Month 1986

	IMPLICIT NONE

	INCLUDE		'($SSDEF)'

	INCLUDE		'LSL$CMNILINK:ILINKMSG.PAR'
	INCLUDE		'LSL$CMNILINK:ILINK.CMN'

C Data in/out
	INTEGER*4	MAXPTS
	INTEGER*4	CC(MAXPTS)
	INTEGER*4	PT_PR_FTR(MAXPTS)
	INTEGER*4	I_PR_FTR		! pr-ftr index
	INTEGER*4	CCD			! capture method code

	REAL*4		PT(2,MAXPTS)
	REAL*4		X,Y			! pt coords

CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	Creates a new point in the PT array at position (X,Y)
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

	CREATE_PT = SS$_NORMAL	! assume success

C Check for point-storage overflow

	IF (N_PTS.EQ.MAXPTS) THEN
	  CREATE_PT = ILINK__TOOMNYPTS
	  CALL LSL_PUTMSG(CREATE_PT,MAXPTS)
	  GOTO 10
	END IF

C Check pt is within range specified (if it is only just out of range
C then force it into range)

	IF (X.LT.XMIN.OR.X.GT.XMAX.OR.Y.LT.YMIN.OR.Y.GT.YMAX) THEN
	  IF (ABS(X-XMIN).LT.ZEROPLUS) X = XMIN
	  IF (ABS(X-XMAX).LT.ZEROPLUS) X = XMAX
	  IF (ABS(Y-YMIN).LT.ZEROPLUS) Y = YMIN
	  IF (ABS(Y-YMAX).LT.ZEROPLUS) Y = YMAX
	  IF (X.LT.XMIN.OR.X.GT.XMAX.OR.Y.LT.YMIN.OR.Y.GT.YMAX) THEN
	    CREATE_PT = ILINK__OUTOFRANGE
	    CALL LSL_PUTMSG(CREATE_PT)
	    GOTO 10
	  END IF
	END IF

C Create new pt with various pt-fields set

	N_PTS = N_PTS+1
	PT(1,N_PTS) = X
	PT(2,N_PTS) = Y
	CC(N_PTS) = CCD
	PT_PR_FTR(N_PTS) = I_PR_FTR

10	IF (CREATE_PT) CREATE_PT = SS$_NORMAL
	RETURN
	END

