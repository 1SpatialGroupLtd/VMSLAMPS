	SUBROUTINE SET_PRV(NXT,PRV,FTR_PTS,MAXPTS,MAXOUTFTRS)

***	IDENT	29MY87
***	MODULE	SET_PRV

C	Copyright : Laser-Scan Laboratories Ltd., Cambridge, England
C	Created   : ACM					Sep 1986

	IMPLICIT NONE

	INCLUDE		'LSL$CMNILINK:ILINK.CMN'

C Data in
	INTEGER*4	MAXPTS,MAXOUTFTRS
	INTEGER*4	NXT(MAXPTS),PRV(MAXPTS)
	INTEGER*4	FTR_PTS(2,MAXOUTFTRS)
	
C Workspace
	INTEGER*4	IPTSTA,IPTFIN		! ftr sta/fin pt indices
	INTEGER*4	IPT			! pt indices
	INTEGER*4	I_PR_FTR		! ftr index

CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	Sets PRV reverse pointers for PT linked-list
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

	DO 30 I_PR_FTR = 1,N_PR_FTRS
	  IPTSTA = FTR_PTS(1,I_PR_FTR)
	  IPTFIN = FTR_PTS(2,I_PR_FTR)
	  IF (IPTSTA.EQ.NIL.OR.IPTFIN.EQ.NIL) GOTO 30	! ftr deleted

	  PRV(IPTSTA) = NIL
	  IPT = IPTSTA
	  GOTO 20

10	  IPT = NXT(IPT)
20	  IF (IPT.EQ.IPTFIN) GOTO 30
	  PRV(NXT(IPT)) = IPT
	  GOTO 10
30	CONTINUE

	END

