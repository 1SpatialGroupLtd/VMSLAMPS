	REAL FUNCTION PUT_DTI_VAL(XCOORD,YCOORD,REAL_VAL)
C
***	MODULE	PUT_DTI_VAL
***	IDENT	07MR88
C
C Copyright Laser-Scan Laboratories Ltd., Cambridge, England
C
C Author M.W.S. Reid
C
C 	Created					MWSR    06-Jan-1988
C
C  puts a DTI value into the currently currently selected DTI file 
C
	IMPLICIT NONE
C
C Arguments
	INTEGER*4	XCOORD,YCOORD	! coords of value
	REAL		REAL_VAL		! the value
C
C Common Blocks
	INCLUDE	'LSL$CMNDTI:DTIPAR.PAR'
	INCLUDE	'LSL$CMNDTI:DTIHDR.CMN'
	INCLUDE	'LSL$CMNROVER:DTICMN.CMN'
	INCLUDE	'LSL$CMNROVER:ROVCMN.CMN'
C
C Functions
	INTEGER*4	DTI_WRITE_DATA
C
C Local Variables
	INTEGER*4		VALUE		! dummy
	INTEGER*2		WVAL
	BYTE			BVAL
	INTEGER*4		LVAL
	INTEGER*4		RET
	REAL			RVAL
C
C equivalencing allows single call to write routine
	EQUIVALENCE		(VALUE,BVAL,RVAL,LVAL)
	EQUIVALENCE             (BVAL,WVAL)
C
	VALUE  = 0
C change according to datatype
	IF (DATA_TYPE(DTICHAN) .EQ. DATA_BYTE) THEN
	   WVAL = NINT(REAL_VAL)
	ELSEIF (DATA_TYPE(DTICHAN) .EQ. DATA_WORD) THEN
	   WVAL = NINT(REAL_VAL)
	ELSEIF (DATA_TYPE(DTICHAN) .EQ. DATA_LONG) THEN
	   LVAL = NINT(REAL_VAL)
	ELSE
	   RVAL = REAL_VAL
	ENDIF
C
	RET = DTI_WRITE_DATA(DTICHAN,VALUE,XCOORD,YCOORD)
C
	RETURN
	END
