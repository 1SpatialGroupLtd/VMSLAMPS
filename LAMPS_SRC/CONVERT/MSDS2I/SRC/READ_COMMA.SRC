	LOGICAL FUNCTION READ_COMMA
C
***	IDENT	08FE88
***	MODULE	READ_COMMA
C
C Copyright (C) LaserScan Laboratories Ltd, Cambridge, England
C Author TJ Ibbs, 3 February 1988
C
C A routine to read and ignore a comma (field separator) from
C an MSDS record
C
C The routine returns TRUE if all went well, and FALSE otherwise
C
	IMPLICIT NONE
C
C Message files
C
	INCLUDE	'HERE:MSDS2IMSG.PAR'
C
C Common files
C
	INCLUDE	'HERE:RECORD.CMN'
	INCLUDE	'HERE:BUFFER.CMN'
C
C Functions
C
	LOGICAL		RDCH		! read a single character
C Workspace
C
	BYTE		ICH		! single character
	LOGICAL		OK		! function return
	INTEGER		IERR		! ditto
C
C *****************************************************************************
C
	IF ( RDCH(ICH) ) THEN
	   CALL LSL_PUTMSG( MSDS2I__UNEXPEOL,RECNUM,'comma/separator' )
	   CALL LSL_ADDBUF(BUFFER,BUFLEN)
	   READ_COMMA = .FALSE.
	ELSE IF ( ICH.NE.COMMA ) THEN
	   CALL LSL_PUTMSG( MSDS2I__COMMA,RECNUM )
	   CALL LSL_ADDBUF(BUFFER,BUFLEN)
	   READ_COMMA = .FALSE.
	ELSE
	   READ_COMMA = .TRUE.
	ENDIF
C
	RETURN
	END
