	LOGICAL FUNCTION CVTDATE (DAYS, DD, MM, YY)
C
***	IDENT	21FE97
***	MODULE	CVTDATE
C
C	Copyright LaserScan Laboratories Ltd., Cambridge, England
C
C Author J Barber, 17 August 1988
C
C This function converts an integer number of days to days, months, 
C   years 
C
C  TRUE for success
C
	IMPLICIT NONE
C
        INTEGER         DAYS            ! input integer no. of days
        INTEGER         YY
        INTEGER         MM
        INTEGER         DD
C
***     COMMON/HERE:PARAMS/
***     PARAMETER/HERE:I2CEDDMSG/
C
C functions called
C
        INTEGER         CVT_DAY_DMY
C
C workspace
C
        INTEGER         RETVAL          ! error return
C
C  ***************************************************************
C be optimistic initially
C
	CVTDATE = .TRUE.
C
        YY = 0
        MM = 0
        DD = 0
C
        RETVAL = CVT_DAY_DMY (DAYS, DD, MM, YY)
        IF (.NOT.RETVAL) THEN
           CALL LSL_PUTMSG (I2CEDD__INVALDAYS, DAYS)
           CALL LSL_PUTMSG (RETVAL)
           YY = -1
           MM = 0
           DD = 0
        ENDIF
C
C	IF (DIAG) CALL WRITEF ('.Date (%N  days) %P %I2/%I2/%I4',
C     &                                         DAYS, DD, MM, YY)
C
999	RETURN		       ! return with it
	END
C
