	LOGICAL FUNCTION CLOSE_FILES (IN_STAT,STAT_LEN)
C
***	IDENT 15JL91
***	MODULE CLOSE_FILES
C
C Copyright Laser-Scan Ltd, Cambridge, England
C
C	Author SG 15-july-199
C
	IMPLICIT NONE
C
C	close index and relative files without checking if they exist
C
	INCLUDE 'HERE:LUNS.PAR'
	INCLUDE 'HERE:COMMANDS.CMN'
C
	CHARACTER*6	IN_STAT
	INTEGER		STAT_LEN
C
	INTEGER		IDLUN
C
C..............................................................................
C
	IF (LOG) THEN
	  IF (IN_STAT(1:STAT_LEN).EQ.'KEEP') THEN
	    CALL WRITEF('%%NTF2I-I-MISC, closing temporary files')
	  ELSE
	    CALL WRITEF('%%NTF2I-I-MISC, closing and deleting temporary files')
	  ENDIF
	ENDIF
C
C	.......................................................................
C
	CLOSE (UNIT = REL_LUN, STATUS = IN_STAT(1:STAT_LEN))
	DO 100 IDLUN = 1,NUM_ID_FILES
	  CLOSE( UNIT = ARRAY_LUN(IDLUN), STATUS = IN_STAT(1:STAT_LEN))
100	CONTINUE
C
C.............................................................................
C
999	CLOSE_FILES = .TRUE.
	RETURN
	END
