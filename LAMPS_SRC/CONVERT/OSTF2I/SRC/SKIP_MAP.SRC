	LOGICAL FUNCTION SKIP_MAP
C
***	IDENT	18AU86
***	MODULE	SKIP_MAP
C
C Copyright (C) LaserScan Laboratories Ltd, Cambridge, England
C
C Author TJ Ibbs, 7 May 1986
C
C To skip to the end of map
C
	IMPLICIT NONE
C
C common blocks
C
	INCLUDE	'CMN:SHEET.CMN'		! for THIS_MAP
C
C functions
C
	LOGICAL		GETREC		! read the next record
	LOGICAL		SKIP_FTR	! skip a feature
	LOGICAL		SKIP_MH		! skip a 2ndary map header
C
C workspace
C
	INTEGER		ICUVAL(2)
	CHARACTER*8	RECORD
C
C *********************************************************************
C assume the worst
C
	SKIP_MAP = .TRUE.
C
C announce what we are doing
C
	CALL WRITEF('Sheet %I2, skipping sheet',THIS_MAP)
C
C read the next line
C
500	IF ( GETREC(RECORD) ) GOTO 9000
505	READ (RECORD,5000) ICUVAL(1),ICUVAL(2)
5000	FORMAT(2I4)
C
C check the flag word - is it end of sheet?
C
	IF ( ICUVAL(1).EQ.-2 ) THEN		! end of sheet found
	   SKIP_MAP = .FALSE.
	   GOTO 9000
	ENDIF
C
	IF ( ICUVAL(1).EQ.-4 ) THEN		! start of feature
	   IF (SKIP_FTR()) GOTO 9000
	ENDIF
C
	IF ( ICUVAL(1).EQ.-20) THEN		! auxiliary map header
	   IF (SKIP_MH(RECORD)) GOTO 9000
	   GOTO 505				! already read record
	ENDIF
C
	GOTO 500				! get the next line
C
C *********************************************************************
C
9000	RETURN
	END
