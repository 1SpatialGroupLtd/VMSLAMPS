	SUBROUTINE ICL(IN,OUT,NUM)
C
***	MODULE	ICL
***	IDENT	29JL87
C
	IMPLICIT NONE
C
C	Copyright Laser-Scan Laboratories Ltd., Cambridge, England
C
C	See .UPD file for updates		RJH	29-Jul-1987
C	Split from ASC				RJH	29-Jul-1987
C
C	Input -  NUM ASCII chracters in IN
C	ICL converts them into ICL 6 bit chracters, and packs them
C	into the bottom 24 bits of each word of long array OUT
C
	INTEGER*2	NUM
	BYTE		IN(*)
	INTEGER*4	OUT(*)
C
	INTEGER*4	I,POS,WORD,CH
	LOGICAL*1	HADNUL
C
	HADNUL = .FALSE.
C
	DO 10 I=1,((NUM-1)/4+1)*4
	  CH = 32  ! pad with spaces
	  IF (I.GT.NUM) GOTO 5
	  IF (IN(I).EQ.0) HADNUL = .TRUE.
	  IF (HADNUL) GOTO 5
	  CH=IN(I)
5	  IF (CH.GE.97.AND.CH.LE.122) CH = CH - 32
	  IF ((CH.AND."100).EQ.0) CH=CH.XOR."20
	  CH=(CH.XOR."40).AND."77
	  POS=18-MOD(I-1,4)*6
	  WORD=(I-1)/4+1
	  CALL LIB$INSV(CH,POS,6,OUT(WORD))
10	CONTINUE
C
20	RETURN
	END
