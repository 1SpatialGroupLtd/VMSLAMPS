	LOGICAL FUNCTION ARRLST(NUM,ATT,VAL,LIST,LISTLEN)
C
***	IDENT	15DE87
***	MODULE	ARRLST
C
C	Copyright Laser-Scan Laboratories Ltd., Cambridge, England
C
C to copy attribute arrays into list of definition
C returns false for disaster
C
C Author R.W. Russell			 10-Dec-1987
C
	IMPLICIT	NONE
C
	INCLUDE 'LSL$CMNIFF:CB.STR'
C
C arguments
C (in)
	INTEGER*4	NUM	! number of attributes
	INTEGER*4	ATT(*)	! array of attributes
	INTEGER*4	VAL(*)	! array of values
C (out)
	INTEGER*4	LIST	! head of definition to copy to
	INTEGER*4	LISTLEN	! the number of elements in the list
C
C w/s
	INTEGER		I
	INTEGER		ADDED
C
C functions
	LOGICAL		ADDDEF
C
	ARRLST = .TRUE.			! success
C
C delete existing entries on list
	CALL DELDEF(LIST)
	LISTLEN = 0
C
C add each element of arrays in turn
	DO 10, I = 1,NUM
C
C don't add absent values
	   IF (VAL(I).EQ.IFF_ABSENT) GOTO 10
	   IF (.NOT.ADDDEF(LIST,ATT(I),VAL(I),ADDED)) THEN
	      ARRLST = .FALSE.
	      GOTO 999
	   ENDIF
	   IF (ADDED) LISTLEN = LISTLEN+1
10	CONTINUE
C
999	RETURN
	END
