	INTEGER FUNCTION GET_OVERLAY_PLANE(PACK)
C
***	MODULE	GET_OVERLAY_PLANE
***	IDENT	11SE90
C
C Copyright Laser Scan Laboratories Ltd., Cambridge, England.
C Author  Ron Russell
C
C Returns the overlay in which to draw the feature - 0 if feature not
C selected in any overlay
C
	IMPLICIT NONE
C
***	PARAMETER/CMN:EFNLUN/
***	PARAMETER/CMN:MOANMESS/
***	PARAMETER/CMN:PACK/
C
***	COMMON/CMN:FCS/
***	COMMON/CMN:LAYERS/
***	COMMON/CMN:MAPS/
***	COMMON/CMN:OVERLAY/
C
C argument
	INTEGER	PACK(PAKLEN)		! pack under consideration
C
C function
	LOGICAL	LIB$EXTZV
C w/s
	INTEGER	OV
C
	DO 100 OV=1,8
C
C is this overlay in use for IFF data
	   IF (.NOT.OVERLAY_IFF(OV)) GOTO 100
C
C is this map selected?
	   IF (.NOT.O_SAMAPS(OV).AND.
     &	       .NOT.O_MAPSEL(PACK(PAKMAP),OV)) GOTO 100
C
C is this overlay to be ignored?
	   IF (.NOT.O_SALAYS(OV).AND.
     &	       .NOT.O_OVSEL(PACK(PAKOVL),OV)) GOTO 100
C
C is this feature code selected?
	   IF (.NOT.O_SAFCS(OV)) THEN
	      IF (.NOT.LIB$EXTZV(PACK(PAKFC),1,O_FCMAP(1,OV))) GOTO 100
	   ENDIF
	   GOTO 200				! selected
100	CONTINUE
C
	OV = 0					! not selected
C
200	CONTINUE
C
	GET_OVERLAY_PLANE = OV
C
	RETURN
	END
