        LOGICAL FUNCTION GEOM_DESTROY(GEOM)
C
***     IDENT	14OC93
***     MODULE  GEOM_DESTROY
C
C       Copyright Laser-Scan Ltd., Cambridge, England.
C
C       Written                                 RWR 	14-Oct-1993
C
C	destroys a geometry
C	returns FALSE for success
C
        IMPLICIT NONE
C
***     PARAMETER/CMN:MOANMESS/
C
***	COMMON/CMN:GEOM/
C
C arguments
	INTEGER		GEOM		! geometry
C
C W/S
	INTEGER		RET_CODE
C
C assume success
	GEOM_DESTROY = .FALSE.
C
	IF (GEOM .NE. 0) THEN
	   CALL CALLR(GEOM, RET_CODE,%VAL(GEOM_ADDRESSES(XGEOM_CANC)))
	   IF (RET_CODE .NE. 0) THEN
	      CALL MOAN(MSG_GEOMERROR)
	      IF (RET_CODE .GT. 0) THEN
		 CALL CALLR(%VAL(RET_CODE),
     &		      RET_CODE,
     &		      %VAL(GEOM_ADDRESSES(XPR_MESS)))
		 CALL WRITEF
	      ENDIF
	      CALL CALLR(%VAL(GEOM_ADDRESSES(XCL_WRK)))
	      GEOM = 0		! I don't know what is wrong
	      GEOM_DESTROY = .TRUE.
	   ENDIF
	ENDIF
C       
        RETURN
        END
