	LOGICAL FUNCTION D14PRL(A1,B1,A2,B2,TOL)
C
***	MODULE	D14PRL
***	IDENT	19JL88
C
	IMPLICIT NONE
C
C Created 					RWR	14-Jul-1988
C
C to test whether two lines are parallel
C lines are in the form Ax + By + C = 0 where either A or B is the 
C tangent or cotangent of the gradient of the line, and the other
C is 1.0
C
***	PARAMETER/CMN:CONSTS/
C
	REAL*8		A1,A2,B1,B2	! coefficients of the lines
	REAL		TOL 		! tolerance (in radians)
C
	REAL*8		D1,D2,D
C
C find the angle of both lines
	IF (A1.NE.0.0.OR.B1.NE.0.0) THEN
	   D1 = ATAN2(A1,B1)
	ELSE
	   D1 = 0.0
	ENDIF
	IF (A2.NE.0.0.OR.B2.NE.0.0) THEN
	   D2 = ATAN2(A2,B2)
	ELSE
	   D2 = 0.0
	ENDIF
C	
C difference between lines
	D = ABS(D1-D2)
C
	D14PRL = (D.LE.TOL).OR.
     &	         (D.GE.(TWOPI-TOL)).OR.
     &	         (D.GE.(PI-TOL).AND.D.LE.(PI+TOL))
C
	RETURN
	END
