	INTEGER FUNCTION GETLAB(STRING,WANT_COLON)
C
***	IDENT	09MY96
***	MODULE	GETLAB
C
C	Copyright Laser-Scan Laboratories Ltd., Cambridge, England.
C
C	Created					CCB	18-Oct-1990
C
C Read a command label
C
	IMPLICIT NONE
C
***     PARAMETER/CMN:CHARS/		! character constants
***     PARAMETER/CMN:MOANMESS/		! moan constants
C
C Arguments
	CHARACTER*(*)	STRING
	LOGICAL		WANT_COLON
C
C Functions called
	LOGICAL		RDCH
	LOGICAL		ALPHA
	LOGICAL		NUMERIC
C
C Workspace
	BYTE		CH
C
	GETLAB = 0
C
10	IF (RDCH(CH)) THEN
	   IF (WANT_COLON.OR.GETLAB.EQ.0) THEN
	      GOTO 9999
	   ELSE
	      GOTO 10000
	   ENDIF
	ENDIF
C
	IF (WANT_COLON.AND.CH.EQ.COLON.AND.GETLAB.GT.0) GOTO 10000
C
	IF (.NOT.(ALPHA(CH).OR.NUMERIC(CH).OR.CH.EQ.UND)) THEN
	   CALL BSCH
	   IF (WANT_COLON) THEN
	      GOTO 9999
	   ELSE
	      GOTO 10000
	   ENDIF
	ENDIF
C
	GETLAB = GETLAB+1
	IF (GETLAB.GT.LEN(STRING)) GOTO 9999
	STRING(GETLAB:GETLAB) = CHAR(CH)
	GOTO 10
C
9999	CALL MOAN(MSG_ILLEGLAB)
	CALL LEARN(MSG_LABELIS)
C
10000	RETURN
	END
