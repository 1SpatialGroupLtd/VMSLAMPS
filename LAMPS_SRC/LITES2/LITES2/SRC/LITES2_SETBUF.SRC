	SUBROUTINE LITES2_SETBUF(SETADR,SETCHS,SETPTR,SETINP,SETARGL,SETARG)
C
***	IDENT	17MY94
***	MODULE	LITES2_SETBUF
C
C	Copyright Laser-Scan Laboratories Ltd., Cambridge, England.
C
C	Created					RJH	15-NOV-1984
C
C Description
C
C    This subroutine is part of the LITES2 Command Interface, and its
C purpose is to set up the a buffer for reading commands.
C    Details of the line to be read are obtained from the top of the
C stack, and are returned by the function as arguments. If a new
C line has just been read in from input, any terminators, spaces or
C tabs preceding the first command will be skipped, and there will be a
C check to ensure that the line is not blank.
C
	IMPLICIT NONE
C
***     COMMON/CMN:DVAR/		! command decoding variables
***     COMMON/CMN:GLOBAL/		! global variables
C
C Arguments
	INTEGER*4	SETADR		! address of input buffer
	INTEGER*4	SETCHS		! no. of chars on current line
	INTEGER*2	SETPTR		! pointer on current line
	INTEGER*4	SETINP		! current input line external ?
	INTEGER*4	SETARGL		! argument string length
	CHARACTER*(*)	SETARG		! argument string
C
C Functions called
	LOGICAL		STAFST		! sets ptr. at first command
	LOGICAL		STANXT		! sets ptr. at next command
C
C Get details of line to read
C
	CALL POPSTK(SETADR,SETCHS,SETPTR,SETINP,SETARGL,SETARG)
C
C Set up auxiliary buffer
C
	IF (.NOT. MOANED) THEN
	   CALL SETAUX(%VAL(SETADR),SETCHS)
C
C Position decode pointer to start of command
C
	   IF (DNEW) THEN
	      DEOLN = STAFST(SETPTR)	! find first comamnd, if any
	   ELSE
	      CALL DCPSET(SETPTR)	! set pointer
	      DEOLN = STANXT(
     &		SETADR,SETCHS,SETPTR,SETINP,SETARGL,SETARG)   ! next cmd
	   ENDIF
	ENDIF
C
	RETURN
	END
