	SUBROUTINE SHSCAL
C
***	MODULE	SHSCAL
***	IDENT	29OC88
C
C Copyright Laser Scan Laboratories Ltd., Cambridge, England
C
C to show how the scale factor was calculated, and to display it
C
	IMPLICIT NONE
C
***	PARAMETER/CMN:EFNLUN/
***	PARAMETER/CMN:MOANMESS/
***	PARAMETER/CMN:STAPAR/
C
***	COMMON/CMN:DRAWIN/
***	COMMON/CMN:MAPS/
***	COMMON/CMN:MASTER/
***	COMMON/CMN:OPTION/
***	COMMON/CMN:SCALES/
***	COMMON/CMN:STATE/
C
C w/s
C
	INTEGER*4	I,J
C
C SCLFRT is such that FRT units (mm) * SCLFRT = IFF units
C
	IF (HADSF) THEN		! use data from SCALE FACTOR
	   CALL INFORM(MSG_SCFRMSF,SCAFAC)
	ELSEIF (HADSA) THEN	! use LIMITS and size of screen
	   CALL INFORM(MSG_SCFRMSA)
	ELSEIF (HADSM.AND.HADSS) THEN
		! use SCALE MAP and SCALE SOURCE
	   CALL INFORM(MSG_SCFRMSMSS,SCAMAP,SCASOU)
	ELSEIF (EXTOPT.AND.MAPTOP.GE.0) THEN
	   IF (HADSM) THEN
	      CALL INFORM(MSG_SCFRMSMMS,SCAMAP)
C
C when no SCALE commands have been given, but EXTERNAL is enabled
C use scale of first map and assume IFF units are in metres 
C (OS case by default)
C
	   ELSE
	      CALL INFORM(MSG_SCFRMMS)
	   ENDIF
C
C if all else has failed, scale is 1
C
	ELSE
	   CALL INFORM(MSG_SCFRMDEF)
	ENDIF
C
	IF (SINDEX.NE.STATE_INITIAL) THEN
	   CALL INFORM(MSG_IFFTOMMS,1/SCLFRT)
	   I=SCLFRT*SCAMAP
	   J=SCAMAP
	   CALL INFORM(MSG_SCALES,I,J)
	   CALL INFORM(MSG_SHEETLIMITS,(LIMITS(2)-LIMITS(1))/SCLFRT,
     &	                               (LIMITS(4)-LIMITS(3))/SCLFRT)
	ELSE
	   CALL INFORM(MSG_AWAITINP)
	ENDIF
C
	RETURN
	END
