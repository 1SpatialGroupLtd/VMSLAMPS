	SUBROUTINE RFBAND(WKID)
C
***	IDENT	06JA86
***	MODULE	RFBAND
C
C	Copyright Laser-Scan Laboratories Ltd., Cambridge, England.
C
C	Created					CCB	10-April-1985
C
C	To refresh rubber band lines
C	WINDOW state treated as a special case - draw a box
C
	IMPLICIT NONE
C
***	PARAMETER/CMN:STAPAR/
C
***     COMMON/CMN:MASTER/
***     COMMON/CMN:RFCTRL/
***     COMMON/CMN:STATE/
***     COMMON/CMN:WORKS/
C
C Arguments
	INTEGER		WKID		! workstation identifier
C
C Local Variables
	INTEGER		START,NUMBER
	REAL		X(5),Y(5)	! temporary coords
C
	IF (WKID.EQ.2) GOTO 200		! ARGS
C
C So must be TEK
C transform coordinates
	IF (RUBLIN(1)) THEN
	   CALL GKSW2D(1,RUBARR(1,1),RUBARR(2,1),X(1),Y(1))
	   CALL MOVTO(X(1),Y(1))
	   IF (SINDEX.EQ.STATE_WINDOW) THEN
	      CALL GKSW2D(1,CSXY(1),CSXY(2),X(2),Y(2))
	      IF (X(2).GT.X(1).AND.Y(2).GT.Y(1)) THEN
	         CALL LINTO(X(1),Y(2))
	         CALL LINTOC
	         CALL LINTO(X(2),Y(1))
	         CALL LINTO(X(1),Y(1))
	      ELSE
	         CALL LINTOC
	      ENDIF
	   ELSE
	      CALL LINTOC
	   ENDIF
	ELSE
	   CALL MOVTOC
	ENDIF
	IF (RUBLIN(2)) THEN
	   CALL GKSW2D(1,RUBARR(1,2),RUBARR(2,2),X(3),Y(3))
	   CALL LINTO(X(3),Y(3))
	ENDIF
	GOTO 900
C
C ARGS
200	X(2) = CSXY(1)
	Y(2) = CSXY(2)
	IF (RUBLIN(1)) THEN
	   X(1) = RUBARR(1,1)
	   Y(1) = RUBARR(2,1)
	   START = 1
	   IF (SINDEX.EQ.STATE_WINDOW.AND.
     &		CSXY(1).GT.X(1).AND.CSXY(2).GT.Y(1)) THEN
	      X(3) = X(2)	! NE corner (cursor)
	      Y(3) = Y(2)
	      X(2) = X(1)	! NW corner (y OK already)
	      X(4) = X(3)	! SE corner
	      Y(4) = Y(1)
	      X(5) = X(1)	! back to SW
	      Y(5) = Y(1)
	      NUMBER = 5
	   ELSE
	      NUMBER = 2
	   ENDIF
	ELSE
	   START = 2
	   NUMBER = 1
	ENDIF
	IF (RUBLIN(2)) THEN
	   X(3) = RUBARR(1,2)
	   Y(3) = RUBARR(2,2)
	   NUMBER = NUMBER+1
	ENDIF
	IF (WKAC(1)) CALL GDAWK(1)
	CALL GPL(NUMBER,X(START),Y(START))
	IF (WKOP(1)) CALL GACWK(1)
C
900	RETURN
	END
