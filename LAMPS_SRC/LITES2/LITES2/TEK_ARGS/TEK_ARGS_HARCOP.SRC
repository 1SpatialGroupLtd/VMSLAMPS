	SUBROUTINE HARCOP
C
***	MODULE	HARCOP
***	IDENT	28MR85
C
C Copyright Laser Scan Laboratories Ltd., Cambridge, England.
C
C	Hardware dependant hardcopy routine
C	   ----   This version is for WOSPLIB TEK	---
C
	IMPLICIT NONE
C
***	PARAMETER/CMN:EFNLUN/
***	PARAMETER/CMN:MOANMESS/
C
***	COMMON/CMN:MAPS/
***	COMMON/CMN:RFCTRL/
***	COMMON/CMN:WORKS/
C
	EXTERNAL	MOAN
C
	INTEGER		I
C
	IF (.NOT.WKAC(1)) GOTO 990	! Tek not available
C
	CALL DISMOD(0)			! cancel refresh mode
C
C disable all workstations but TEK
	DO 310, I=2,WSMAX
	   IF (WKAC(I)) CALL GDAWK(I)
310	CONTINUE
C
C draw markers at corners of maps
	CALL DRAWX   
C
C reactivate non-TEK worksatations
	DO 390, I=2,WSMAX
	   IF (WKOP(I)) CALL GACWK(I)
390	CONTINUE
C
C  now draw hardcopy
C
	CALL TKCOPY
	RFCURS = .NOT.CURS		! force refresh re-draw
	GOTO 999
C
C error exit
990	CALL MSGCMD(MOAN,MSG_COMONPRI)
	CALL IGNCMD
C
999	RETURN
	END
