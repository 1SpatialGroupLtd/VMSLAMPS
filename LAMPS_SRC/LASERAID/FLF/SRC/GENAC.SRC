	SUBROUTINE GENAC
C
***	MODULE	GENAC
***	IDENT	25JL86
C
C Copyright Laser-Scan Laboratories Limited, Cambridge, England.
C
C Author: D. Meader
C
C	Created 				 DM	25-Jul-1986
C
C AC type value [text] - insert an AC entry in the file at the current
C writing position.
C 'value' is examined for a decimal point and is stored as a real number
C if one is found. AC type 3 is a special case and is ALWAYS stored as a
C real (the decimal point may be omitted if appropriate).
C
**	IF VAX
	IMPLICIT NONE
**	ENDC
C
***	PARAMETER/PARAMS/
C
***	COMMON/MASTER/
***	COMMON/TXTC/
C
	BYTE	  ICH		! single character
	INTEGER*2 III,JJJ
	INTEGER*4 LLL
C
C functions:
	INTEGER	  EXPAND
	LOGICAL	  RDCH
	LOGICAL	  RDCHS
	LOGICAL	  RDINT
	LOGICAL	  RDLONG
	LOGICAL	  RDREAL
C
C ......................................................................
C
	IF (RDINT(JJJ)) GO TO 50		! get the AC type
	JJJ=JJJ + ACBASE			! add any base value
	IF (JJJ.LE.0) GO TO 50			! zero is illegal
	IF (RDCHS(ICH)) GO TO 60		! prepare to get value
	III=DCPTR - 1
	IF (JJJ.EQ.3) GO TO 30			! AC 3 is special
10	IF (ICH.EQ.'.') GO TO 30		! look for decimal point
	IF (RDCH(ICH)) GO TO 20
	IF (ICH.NE.' ') GO TO 10
20	DCPTR=III				! it's an integer
	IF (RDLONG(LLL)) GO TO 60
	GO TO 40
30	DCPTR=III				! it's a real
	IF (RDREAL(LLL)) GO TO 60
40	IF (.NOT.RDCHS(ICH)) CALL BSCH		! look for text
	CALL IFFAC(JJJ,LLL,TXTBUF(DCPTR))
	GO TO 70
C
50	CALL WRITEF('Illegal AC type')
	GO TO 70
60	CALL WRITEF('Illegal AC value')
C
70	RETURN
	END
