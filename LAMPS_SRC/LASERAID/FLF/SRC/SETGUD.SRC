	SUBROUTINE SETGUD(NEWFIL)
C
***	MODULE	SETGUD
***	IDENT	28FE86
C
C Copyright Laser-Scan Laboratories Limited, Cambridge, England.
C
CMOD	STRLEN introduced; tidied		 DM	28-Feb-1986
CMOD	/COEFFS/ removed			AJW	07-Apr-1983
CMOD	PDP version uses EFNETC			AJW	06-Jul-1981
CMOD	NUMC changed to EXPC			AJW	07-May-1981
CMOD	Tidied					AJW	10-Feb-1981
CMOD	Created					MCF	13-Jun-1978
C
C Close any open guidance file, open a new one if NEWFIL.
C
**	IF VAX
	IMPLICIT NONE
**	ENDC
C
***	PARAMETER/PARAMS/
C
	LOGICAL*1 NEWFIL	! new file to be opened ?
C
***	COMMON/EFNETC/
***	COMMON/GUIDE/
***	COMMON/IFFHAN/
C
C function:
	INTEGER*4 STRLEN
C
C ......................................................................
C
C close any open file.
	IF (GUDOPN) CALL IFFCLO(SAVLUN)
	GUDOPN=.FALSE.
	SKPGUD=0
	IF (.NOT.NEWFIL) GO TO 10
C
C open a new file.
	CALL LINOUT(GUDNAM(1:STRLEN(GUDNAM)))
	CALL IFFOPN(SAVLUN,GUDNAM)
	IF (IERCD.NE.0) GO TO 10
	CALL IFFRWD			! position the file
	GUDOPN=.TRUE.
C
10	CALL IFFSEL(IFFLUN)
	RETURN
	END
