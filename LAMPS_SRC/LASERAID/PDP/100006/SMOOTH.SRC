	SUBROUTINE SMOOTH(JCHAIN,IU,IV)
C
C Copyright Laser-Scan Laboratories Ltd,Cambridge,England
C Author Paul Hardy
C
C 	Created 14.vi.78
C	Last edited 14/vi/78
C
C to smooth out kinks in a chain
C
***	COMMON/PARAMS/
***	COMMON/RSE/
***	COMMON/LINKS/
C
	INTEGER JCHAIN	! chain to be smoothed
	INTEGER V(3)
C
	J = CHAIN(JCHAIN)
	IF (J .EQ. 0) GOTO 80
	IF (NXT(J) .EQ. 0) GOTO 80
	I = J
	V(2)=NEBUF(IV+1,J)
	V(3)=V(2)
C
10	K=J
	J=I
	I = NXT(I)
	V(1)=V(2)
	V(2)=V(3)
	IF(I.NE.0) V(3)=NEBUF(IV+1,I)
	NEBUF(IV+1,J)=FLOAT(V(1)+V(2)+V(3))/3.  ! mean of three
	IF(I.NE.0) GOTO 10
C
80	RETURN
	END
