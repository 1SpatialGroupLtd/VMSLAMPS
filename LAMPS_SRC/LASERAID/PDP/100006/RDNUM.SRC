	LOGICAL FUNCTION RDINT(I)
C
C Copyright Laser-Scan Laboratories Ltd,Cambridge,England
C
C Author M.C.Fulford
C
C	Created 26/i/79
C
C To read in a number from a line of text
C Result is .TRUE. if no digits are read
C
C 
***	COMMON/PARAMS/
C
C arguments
	INTEGER I	! where the number goes
C
***	COMMON/TEXTC/
C
C w/s
	INTEGER ICH	! character
	INTEGER SIGN	! sign of number (0 if none so far)
	INTEGER BASE	! numerical base
C
C
	BASE = 10	! decimal
	GOTO 5
C
C 
	ENTRY RDOCT (I)
C
C To read a number to base 8
C
	BASE = 8
C
C
5	I = 0
	RDINT = .TRUE.
	DCPTR = DCPTR-1
	SIGN = 1		! to make it zero 1st time through
C + & - signs jump back to ...
10	SIGN = SIGN-2		! ... here (-) or ...
20	SIGN = SIGN+1		! ... here (+)
C extract next character
30	DCPTR = DCPTR+1
	IF (DCPTR .GT. TXTPTR) GOTO 90
	ICH = TXTBUF(DCPTR)
	IF (SIGN .NE. 0) GOTO 40
C leading items
	IF (ICH .EQ. "40) GOTO 30	! space
	IF (ICH .EQ. "55) GOTO 10	! minus
	IF (ICH .EQ. "53) GOTO 20	! plus
C digits
40	ICH = ICH-"60
	IF (ICH.LT.0 .OR. ICH.GE.BASE) GOTO 90
	IF (SIGN .EQ. 0) SIGN = 1	! implicit plus
	I = I*BASE + ICH*SIGN
	RDINT = .FALSE.
	GOTO 30
C
C end of number
90	RETURN
	END
